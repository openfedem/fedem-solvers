<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FEDEM Solver: solverroutinesmodule Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FEDEM Solver
   &#160;<span id="projectnumber">R8.0</span>
   </div>
   <div id="projectbrief">Source code of the dynamics solver</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">solverroutinesmodule Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Module with some generic solver utilities.  
<a href="namespacesolverroutinesmodule.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a5c310a227a63c05c486addd60a4891a0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolverroutinesmodule.html#a5c310a227a63c05c486addd60a4891a0">calculateiterationnorms</a> (sam, sys, iter, ierr)</td></tr>
<tr class="memdesc:a5c310a227a63c05c486addd60a4891a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates all iteration norms defined in the system.  <a href="namespacesolverroutinesmodule.html#a5c310a227a63c05c486addd60a4891a0">More...</a><br /></td></tr>
<tr class="separator:a5c310a227a63c05c486addd60a4891a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73a769e7f7927fb702153d69b02a162d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolverroutinesmodule.html#a73a769e7f7927fb702153d69b02a162d">calculateiterationtolerances</a> (sam, sys)</td></tr>
<tr class="memdesc:a73a769e7f7927fb702153d69b02a162d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates all iteration tolerances defined in the system.  <a href="namespacesolverroutinesmodule.html#a73a769e7f7927fb702153d69b02a162d">More...</a><br /></td></tr>
<tr class="separator:a73a769e7f7927fb702153d69b02a162d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c92134107339e8821b570b02170bd68"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolverroutinesmodule.html#a7c92134107339e8821b570b02170bd68">iterationaccelerator</a> (iter, res, del, ierr)</td></tr>
<tr class="memdesc:a7c92134107339e8821b570b02170bd68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Accelerates the solution increment in case of line search.  <a href="namespacesolverroutinesmodule.html#a7c92134107339e8821b570b02170bd68">More...</a><br /></td></tr>
<tr class="separator:a7c92134107339e8821b570b02170bd68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7716799bcfc2860355c412a4ee3da400"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolverroutinesmodule.html#a7716799bcfc2860355c412a4ee3da400">savestep</a> (sys, mech, ctrl, ierr, checkTimeStep)</td></tr>
<tr class="memdesc:a7716799bcfc2860355c412a4ee3da400"><td class="mdescLeft">&#160;</td><td class="mdescRight">Saves response variables of current time step to file.  <a href="namespacesolverroutinesmodule.html#a7716799bcfc2860355c412a4ee3da400">More...</a><br /></td></tr>
<tr class="separator:a7716799bcfc2860355c412a4ee3da400"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e7d7fdcf7ac2ad0fb0d0ec9072ecb1f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolverroutinesmodule.html#a2e7d7fdcf7ac2ad0fb0d0ec9072ecb1f">terminatestep</a> (sam, sys, mech, ctrl, linearStatic, finalStep, ierr)</td></tr>
<tr class="memdesc:a2e7d7fdcf7ac2ad0fb0d0ec9072ecb1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Terminates a time step by doing some final calculations.  <a href="namespacesolverroutinesmodule.html#a2e7d7fdcf7ac2ad0fb0d0ec9072ecb1f">More...</a><br /></td></tr>
<tr class="separator:a2e7d7fdcf7ac2ad0fb0d0ec9072ecb1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3680756ba4e87795f19474addfe247e6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolverroutinesmodule.html#a3680756ba4e87795f19474addfe247e6">updatepreviousstate</a> (sam, sys, mech, ierr)</td></tr>
<tr class="memdesc:a3680756ba4e87795f19474addfe247e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the previous state variables in the mechanism objects.  <a href="namespacesolverroutinesmodule.html#a3680756ba4e87795f19474addfe247e6">More...</a><br /></td></tr>
<tr class="separator:a3680756ba4e87795f19474addfe247e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5ddd72d067b73dcf0a8e8f0cfd327c5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolverroutinesmodule.html#af5ddd72d067b73dcf0a8e8f0cfd327c5">restorelaststep</a> (sam, sys, mech)</td></tr>
<tr class="memdesc:af5ddd72d067b73dcf0a8e8f0cfd327c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Restores all state variables from the last converged time step.  <a href="namespacesolverroutinesmodule.html#af5ddd72d067b73dcf0a8e8f0cfd327c5">More...</a><br /></td></tr>
<tr class="separator:af5ddd72d067b73dcf0a8e8f0cfd327c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16e64e86145517d42b80f4a82b533c7c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolverroutinesmodule.html#a16e64e86145517d42b80f4a82b533c7c">clearvelacc</a> (triads, joints, notify)</td></tr>
<tr class="memdesc:a16e64e86145517d42b80f4a82b533c7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clears velocity and acceleration variables in the triads and joints.  <a href="namespacesolverroutinesmodule.html#a16e64e86145517d42b80f4a82b533c7c">More...</a><br /></td></tr>
<tr class="separator:a16e64e86145517d42b80f4a82b533c7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed06fccf80606c95ebe42d4c7c737eb1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolverroutinesmodule.html#aed06fccf80606c95ebe42d4c7c737eb1">closesolverdb</a> (mech, anyRes, ierr)</td></tr>
<tr class="memdesc:aed06fccf80606c95ebe42d4c7c737eb1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Closes all solver data base files before program termination.  <a href="namespacesolverroutinesmodule.html#aed06fccf80606c95ebe42d4c7c737eb1">More...</a><br /></td></tr>
<tr class="separator:aed06fccf80606c95ebe42d4c7c737eb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3eb8050e2ed46f4bdcbf7e87035244bf"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolverroutinesmodule.html#a3eb8050e2ed46f4bdcbf7e87035244bf">printmassdistribution</a> (sups, masses, tires, elms, gravity, totMass, lpu)</td></tr>
<tr class="memdesc:a3eb8050e2ed46f4bdcbf7e87035244bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints a summary of the mass distribution to the res-file.  <a href="namespacesolverroutinesmodule.html#a3eb8050e2ed46f4bdcbf7e87035244bf">More...</a><br /></td></tr>
<tr class="separator:a3eb8050e2ed46f4bdcbf7e87035244bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af08eaa1ab32fc8aeae97e755e4355894"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolverroutinesmodule.html#af08eaa1ab32fc8aeae97e755e4355894">printresults</a> (time, triads, sups, iprint, lpu)</td></tr>
<tr class="memdesc:af08eaa1ab32fc8aeae97e755e4355894"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints basic simulation variables to the res-file.  <a href="namespacesolverroutinesmodule.html#af08eaa1ab32fc8aeae97e755e4355894">More...</a><br /></td></tr>
<tr class="separator:af08eaa1ab32fc8aeae97e755e4355894"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07c6727b5bc6cfb5d5614996cd11f5eb"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolverroutinesmodule.html#a07c6727b5bc6cfb5d5614996cd11f5eb">printconvergence</a> (lpu, fileFormat, iStep, iter, tanUpdate, time, timeStep, del, res, convData, sam, mech)</td></tr>
<tr class="memdesc:a07c6727b5bc6cfb5d5614996cd11f5eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints convergence information to the res-file.  <a href="namespacesolverroutinesmodule.html#a07c6727b5bc6cfb5d5614996cd11f5eb">More...</a><br /></td></tr>
<tr class="separator:a07c6727b5bc6cfb5d5614996cd11f5eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a2a7bb7d79f8b0051469b04c07d4117cd"><td class="memItemLeft" align="right" valign="top">integer(ik), dimension(:), allocatable, save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolverroutinesmodule.html#a2a7bb7d79f8b0051469b04c07d4117cd">meqerr</a></td></tr>
<tr class="memdesc:a2a7bb7d79f8b0051469b04c07d4117cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">All singular equations found.  <a href="namespacesolverroutinesmodule.html#a2a7bb7d79f8b0051469b04c07d4117cd">More...</a><br /></td></tr>
<tr class="separator:a2a7bb7d79f8b0051469b04c07d4117cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad345650407eb0d405ae52337c58d4fa5"><td class="memItemLeft" align="right" valign="top">real(dp), dimension(4), save, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolverroutinesmodule.html#ad345650407eb0d405ae52337c58d4fa5">lastime</a> = -1.0e99_dp</td></tr>
<tr class="memdesc:ad345650407eb0d405ae52337c58d4fa5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Previous save times.  <a href="namespacesolverroutinesmodule.html#ad345650407eb0d405ae52337c58d4fa5">More...</a><br /></td></tr>
<tr class="separator:ad345650407eb0d405ae52337c58d4fa5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Module with some generic solver utilities. </p>
<p>This module contains utility subroutines for the Dynamics Solver that are not related to any specific solution algorithm or mechanism part. Many of the subroutines and functions of this module are not documented. You have to configure doxygen with the option ENABLED_SECTIONS = FULL_DOC to extract detailed documentation of those subroutines and functions. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a5c310a227a63c05c486addd60a4891a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c310a227a63c05c486addd60a4891a0">&#9670;&nbsp;</a></span>calculateiterationnorms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine solverroutinesmodule::calculateiterationnorms </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structsammodule_1_1samtype.html">samtype</a>), intent(in)&#160;</td>
          <td class="paramname"><em>sam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structsystemtypemodule_1_1systemtype.html">systemtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>sys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>ierr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates all iteration norms defined in the system. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sam</td><td>Data for managing system matrix assembly </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">sys</td><td>System level model data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iter</td><td>Iteration counter </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ierr</td><td>Error flag</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Bjorn Haugen </dd></dl>
<dl class="section date"><dt>Date</dt><dd>12 Apr 2003</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Knut Morten Okstad </dd></dl>
<dl class="section date"><dt>Date</dt><dd>29 Jan 2004 </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolverroutinesmodule_a5c310a227a63c05c486addd60a4891a0_cgraph.png" border="0" usemap="#anamespacesolverroutinesmodule_a5c310a227a63c05c486addd60a4891a0_cgraph" alt=""/></div>
<map name="anamespacesolverroutinesmodule_a5c310a227a63c05c486addd60a4891a0_cgraph" id="anamespacesolverroutinesmodule_a5c310a227a63c05c486addd60a4891a0_cgraph">
<area shape="rect" title="Calculates all iteration norms defined in the system." alt="" coords="5,90,191,131"/>
<area shape="rect" href="namespacenormtypemodule.html#ac122a41c8ab74681406822e2215475d7" title=" " alt="" coords="239,5,491,32"/>
<area shape="rect" href="namespacenormroutinesmodule.html#a852dd09321a1ed6858c4e74538cd6cd5" title="Calculates energy norms for given force and displacement vectors." alt="" coords="285,122,444,163"/>
<area shape="rect" href="namespacenormroutinesmodule.html#a2b350dab276ba8af3f77a0f71cd7fff3" title="Calculates infinity norms of the given vector." alt="" coords="285,187,444,229"/>
<area shape="rect" href="namespacenormroutinesmodule.html#a51c8312190f783a6271fdc481e797a22" title="Calculates the scaled norm of the given vector." alt="" coords="285,57,444,98"/>
<area shape="rect" href="namespacenormroutinesmodule.html#ac496980953eb98dc898429cd5741382c" title="Returns a pointer to the expanded solution vector." alt="" coords="541,122,699,163"/>
<area shape="rect" href="namespacesearchandsortmodule.html#a0a5e7bf805015a87a8e996d9e451ba66" title="Finds indices of the largest values in the given real array." alt="" coords="539,187,701,229"/>
<area shape="rect" href="namespacesolextensionmodule.html#a3b1e9bd2748417226594ceaab32ca03d" title="Expands and rearranges a solution vector." alt="" coords="751,90,905,131"/>
<area shape="rect" href="namespacescratcharraymodule.html#ae10f22e9df252a0c329b145347d2fc1f" title="Returns a pointer to a real(dp) scratch array." alt="" coords="749,155,907,197"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolverroutinesmodule_a5c310a227a63c05c486addd60a4891a0_icgraph.png" border="0" usemap="#anamespacesolverroutinesmodule_a5c310a227a63c05c486addd60a4891a0_icgraph" alt=""/></div>
<map name="anamespacesolverroutinesmodule_a5c310a227a63c05c486addd60a4891a0_icgraph" id="anamespacesolverroutinesmodule_a5c310a227a63c05c486addd60a4891a0_icgraph">
<area shape="rect" title="Calculates all iteration norms defined in the system." alt="" coords="853,39,1039,80"/>
<area shape="rect" href="namespacenewmarkroutinesmodule.html#a4998597a0918626e80be5fcf91c40819" title="Advances the dynamics solution one step forward." alt="" coords="620,5,805,47"/>
<area shape="rect" href="namespacestaticequilibriummodule.html#aac6e8c83f3a0d690bf57832bf35012bf" title="Advances the quasi&#45;static solution one time step." alt="" coords="622,71,803,112"/>
<area shape="rect" href="namespacesolvermodule.html#a048f4879c526c74e1ae704bc1cf2dd48" title="Solves for the next time step or iteration." alt="" coords="389,46,572,73"/>
<area shape="rect" href="solverDriver_8f90.html#ac030f2d9c9b0bb0d9f6378bb2245cde8" title="Solves the next time increment by Newton&#45;Raphson iterations." alt="" coords="5,46,83,73"/>
<area shape="rect" href="namespaceinversemodule.html#a9502b109b6230e372fe609566135d17e" title=" " alt="" coords="131,46,341,73"/>
<area shape="rect" href="namespacesolvermodule.html#a1b92706b06bc176f7c61a0e3d4a427f1" title="Solves the ramp&#45;up stage, if any." alt="" coords="134,97,338,123"/>
</map>
</div>

</div>
</div>
<a id="a73a769e7f7927fb702153d69b02a162d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73a769e7f7927fb702153d69b02a162d">&#9670;&nbsp;</a></span>calculateiterationtolerances()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine solverroutinesmodule::calculateiterationtolerances </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structsammodule_1_1samtype.html">samtype</a>), intent(in)&#160;</td>
          <td class="paramname"><em>sam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structsystemtypemodule_1_1systemtype.html">systemtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>sys</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates all iteration tolerances defined in the system. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sam</td><td>Data for managing system matrix assembly </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">sys</td><td>System level model data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Bjorn Haugen</dd></dl>
<dl class="section date"><dt>Date</dt><dd>12 Apr 2003 </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolverroutinesmodule_a73a769e7f7927fb702153d69b02a162d_cgraph.png" border="0" usemap="#anamespacesolverroutinesmodule_a73a769e7f7927fb702153d69b02a162d_cgraph" alt=""/></div>
<map name="anamespacesolverroutinesmodule_a73a769e7f7927fb702153d69b02a162d_cgraph" id="anamespacesolverroutinesmodule_a73a769e7f7927fb702153d69b02a162d_cgraph">
<area shape="rect" title="Calculates all iteration tolerances defined in the system." alt="" coords="5,5,217,47"/>
<area shape="rect" href="namespacenormroutinesmodule.html#a6155a1f7ea95c1fcbbfad47f1e294a8e" title="Defines the convergence tolerance to use for a given test item." alt="" coords="265,5,424,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolverroutinesmodule_a73a769e7f7927fb702153d69b02a162d_icgraph.png" border="0" usemap="#anamespacesolverroutinesmodule_a73a769e7f7927fb702153d69b02a162d_icgraph" alt=""/></div>
<map name="anamespacesolverroutinesmodule_a73a769e7f7927fb702153d69b02a162d_icgraph" id="anamespacesolverroutinesmodule_a73a769e7f7927fb702153d69b02a162d_icgraph">
<area shape="rect" title="Calculates all iteration tolerances defined in the system." alt="" coords="620,226,832,267"/>
<area shape="rect" href="namespacesolvermodule.html#a98becc18e10e1c5bd8ac605048e0aebe" title="Initializes the simulation model." alt="" coords="393,132,568,159"/>
<area shape="rect" href="namespacesolvermodule.html#a048f4879c526c74e1ae704bc1cf2dd48" title="Solves for the next time step or iteration." alt="" coords="389,284,572,311"/>
<area shape="rect" href="solverDriver_8f90.html#aa07e0fdca0c16c6bded8d8219dd3d3dc" title="Initializes a new simulation process." alt="" coords="197,5,275,32"/>
<area shape="rect" href="solverDriver_8f90.html#a28abf5f95b1e2d8dd4ae6c17f1f2d31a" title="Initializes a new simulation process." alt="" coords="197,56,275,83"/>
<area shape="rect" href="solverDriver_8f90.html#a43ba8eaac9f6ae5dd0a945584c31bf82" title="Initializes a new simulation process." alt="" coords="197,107,275,133"/>
<area shape="rect" href="solverDriver_8f90.html#a8e14233207067f1085bb7931cc1f7277" title="Initializes a new simulation process and restarts from provided state." alt="" coords="198,157,274,184"/>
<area shape="rect" href="solverDriver_8f90.html#abc8381a16b5750477e6f6c5e5f79acde" title="Initializes a new simulation process and restarts from provided state." alt="" coords="197,208,275,235"/>
<area shape="rect" href="solverDriver_8f90.html#ac030f2d9c9b0bb0d9f6378bb2245cde8" title="Solves the next time increment by Newton&#45;Raphson iterations." alt="" coords="5,309,83,336"/>
<area shape="rect" href="namespaceinversemodule.html#a9502b109b6230e372fe609566135d17e" title=" " alt="" coords="131,309,341,336"/>
<area shape="rect" href="namespacesolvermodule.html#a1b92706b06bc176f7c61a0e3d4a427f1" title="Solves the ramp&#45;up stage, if any." alt="" coords="134,360,338,387"/>
</map>
</div>

</div>
</div>
<a id="a16e64e86145517d42b80f4a82b533c7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16e64e86145517d42b80f4a82b533c7c">&#9670;&nbsp;</a></span>clearvelacc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine solverroutinesmodule::clearvelacc </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structtriadtypemodule_1_1triadtype.html">triadtype</a>), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>triads</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmasterslavejointtypemodule_1_1masterslavejointtype.html">masterslavejointtype</a>), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>joints</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>notify</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clears velocity and acceleration variables in the triads and joints. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">triads</td><td>All triads in the model </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">joints</td><td>All joints in the model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">notify</td><td>If .true., give message if a non-zero variable is cleared</td></tr>
  </table>
  </dd>
</dl>
<p>This subroutine will (re)set the velocity- and accelerations variables in all triads and joints to zero. It mainly is used to nullify potentially non-zero initial conditions in the case of quasi-static load incrementation, in which inertia and damping terms should be zero, such that a possible dynamic restart will be performed from a resting state. Notice that the velocity/accelerations of the generalized DOFs in super- elements do not need to be reset, since those variables are pointers into respective system vectors which are assumed to be initialized separately.</p>
<dl class="section author"><dt>Author</dt><dd>Guenter Glanzer</dd></dl>
<dl class="section date"><dt>Date</dt><dd>24 Aug 2022 </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolverroutinesmodule_a16e64e86145517d42b80f4a82b533c7c_icgraph.png" border="0" usemap="#anamespacesolverroutinesmodule_a16e64e86145517d42b80f4a82b533c7c_icgraph" alt=""/></div>
<map name="anamespacesolverroutinesmodule_a16e64e86145517d42b80f4a82b533c7c_icgraph" id="anamespacesolverroutinesmodule_a16e64e86145517d42b80f4a82b533c7c_icgraph">
<area shape="rect" title="Clears velocity and acceleration variables in the triads and joints." alt="" coords="857,135,1021,177"/>
<area shape="rect" href="namespacestaticequilibriummodule.html#ae099843d3bb1498026518a0f5d321b37" title="Updates the configuration after initial static equilibrium." alt="" coords="608,103,789,145"/>
<area shape="rect" href="namespacerestartmodule.html#a3cc4a3b3f2214de1013479ff69317376" title="Initializes the mechanism configuration for restart." alt="" coords="588,172,809,199"/>
<area shape="rect" href="namespacestaticequilibriummodule.html#a0f1bc8d14ea2d090018de7485bf8a2ae" title="Performs static equilibrium iterations to find start configuration." alt="" coords="356,99,537,141"/>
<area shape="rect" href="namespacesolvermodule.html#a98becc18e10e1c5bd8ac605048e0aebe" title="Initializes the simulation model." alt="" coords="131,107,305,133"/>
<area shape="rect" href="solverDriver_8f90.html#aa07e0fdca0c16c6bded8d8219dd3d3dc" title="Initializes a new simulation process." alt="" coords="5,5,83,32"/>
<area shape="rect" href="solverDriver_8f90.html#a28abf5f95b1e2d8dd4ae6c17f1f2d31a" title="Initializes a new simulation process." alt="" coords="5,56,83,83"/>
<area shape="rect" href="solverDriver_8f90.html#a43ba8eaac9f6ae5dd0a945584c31bf82" title="Initializes a new simulation process." alt="" coords="5,107,83,133"/>
<area shape="rect" href="solverDriver_8f90.html#a8e14233207067f1085bb7931cc1f7277" title="Initializes a new simulation process and restarts from provided state." alt="" coords="6,157,82,184"/>
<area shape="rect" href="solverDriver_8f90.html#abc8381a16b5750477e6f6c5e5f79acde" title="Initializes a new simulation process and restarts from provided state." alt="" coords="5,208,83,235"/>
<area shape="rect" href="interfacerestartmodule_1_1restartinit.html#a56f750656488e46fbc372f5f40e01e89" title="Initializes the mechanism configuration from provided state array." alt="" coords="353,165,540,206"/>
<area shape="rect" href="interfacerestartmodule_1_1restartinit.html#a22a8fa07efb07ca2ff6c86723442ea72" title="Initializes the mechanism configuration from restart file." alt="" coords="353,230,540,271"/>
</map>
</div>

</div>
</div>
<a id="aed06fccf80606c95ebe42d4c7c737eb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed06fccf80606c95ebe42d4c7c737eb1">&#9670;&nbsp;</a></span>closesolverdb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine solverroutinesmodule::closesolverdb </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmechanismtypemodule_1_1mechanismtype.html">mechanismtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>mech</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>anyRes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>ierr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Closes all solver data base files before program termination. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">mech</td><td>Mechanism components of the model </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">anyRes</td><td>Indicates whether the result files contain data or not </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ierr</td><td>Error flag</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Knut Morten Okstad</dd></dl>
<dl class="section date"><dt>Date</dt><dd>30 Jan 2006 </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolverroutinesmodule_aed06fccf80606c95ebe42d4c7c737eb1_cgraph.png" border="0" usemap="#anamespacesolverroutinesmodule_aed06fccf80606c95ebe42d4c7c737eb1_cgraph" alt=""/></div>
<map name="anamespacesolverroutinesmodule_aed06fccf80606c95ebe42d4c7c737eb1_cgraph" id="anamespacesolverroutinesmodule_aed06fccf80606c95ebe42d4c7c737eb1_cgraph">
<area shape="rect" title="Closes all solver data base files before program termination." alt="" coords="5,57,169,98"/>
<area shape="rect" href="namespacesavemodule.html#a530c7fc644ef5374dd298d76f6631e82" title="Closes the results database file(s)." alt="" coords="217,5,425,32"/>
<area shape="rect" href="namespacetireroutinesmodule.html#a6fde006223d686f83af46a5bfc95856b" title=" " alt="" coords="248,57,395,98"/>
<area shape="rect" href="namespacesavevtfmodule.html#a81d77243bbbd06f4e4e51f977513ad9a" title=" " alt="" coords="231,123,411,149"/>
<area shape="rect" href="namespacerdbmodule.html#a99b9c7ba1d0f94026ee0cc36c322ac6f" title="Closes the specified results database file." alt="" coords="473,5,648,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolverroutinesmodule_aed06fccf80606c95ebe42d4c7c737eb1_icgraph.png" border="0" usemap="#anamespacesolverroutinesmodule_aed06fccf80606c95ebe42d4c7c737eb1_icgraph" alt=""/></div>
<map name="anamespacesolverroutinesmodule_aed06fccf80606c95ebe42d4c7c737eb1_icgraph" id="anamespacesolverroutinesmodule_aed06fccf80606c95ebe42d4c7c737eb1_icgraph">
<area shape="rect" title="Closes all solver data base files before program termination." alt="" coords="841,294,1005,335"/>
<area shape="rect" href="namespacesolvermodule.html#aef77c02d4ed38569accb6f1fe2e7e636" title="Closes the result database files and any external modules used." alt="" coords="624,301,793,328"/>
<area shape="rect" href="namespacesolvermodule.html#a6e3fefff7a29d4f24d7b52a11cba43bd" title="Terminates the simulation and close the result database." alt="" coords="399,56,566,83"/>
<area shape="rect" href="namespacesolvermodule.html#a98becc18e10e1c5bd8ac605048e0aebe" title="Initializes the simulation model." alt="" coords="395,183,570,209"/>
<area shape="rect" href="namespacesolvermodule.html#ad942a07a7186496388f9fd3a54918faf" title="Restarts a running simulation model from the provided state." alt="" coords="389,301,576,328"/>
<area shape="rect" href="namespacefreqresponsemodule.html#ab724a650574c61985d742a7f0d21279c" title="Interface to the frequency&#45;domain solver module in Fedem." alt="" coords="405,353,561,394"/>
<area shape="rect" href="namespacesolvermodule.html#a048f4879c526c74e1ae704bc1cf2dd48" title="Solves for the next time step or iteration." alt="" coords="391,440,574,467"/>
<area shape="rect" href="solverDriver_8f90.html#a688267739853d43d34189be1365d3e33" title="Terminates the running solver process by deallocating all memory, etc." alt="" coords="196,5,276,32"/>
<area shape="rect" href="solverDriver_8f90.html#aa07e0fdca0c16c6bded8d8219dd3d3dc" title="Initializes a new simulation process." alt="" coords="197,56,275,83"/>
<area shape="rect" href="solverDriver_8f90.html#a28abf5f95b1e2d8dd4ae6c17f1f2d31a" title="Initializes a new simulation process." alt="" coords="197,107,275,133"/>
<area shape="rect" href="solverDriver_8f90.html#a43ba8eaac9f6ae5dd0a945584c31bf82" title="Initializes a new simulation process." alt="" coords="197,157,275,184"/>
<area shape="rect" href="solverDriver_8f90.html#a8e14233207067f1085bb7931cc1f7277" title="Initializes a new simulation process and restarts from provided state." alt="" coords="198,208,274,235"/>
<area shape="rect" href="solverDriver_8f90.html#abc8381a16b5750477e6f6c5e5f79acde" title="Initializes a new simulation process and restarts from provided state." alt="" coords="197,259,275,285"/>
<area shape="rect" href="solverDriver_8f90.html#a53a8d5ea2434ae00f5bf28cf66196cc3" title="Restarts a running solver process from the provided state." alt="" coords="191,309,281,336"/>
<area shape="rect" href="solverDriver_8f90.html#ac030f2d9c9b0bb0d9f6378bb2245cde8" title="Solves the next time increment by Newton&#45;Raphson iterations." alt="" coords="5,411,83,437"/>
<area shape="rect" href="namespaceinversemodule.html#a9502b109b6230e372fe609566135d17e" title=" " alt="" coords="131,461,341,488"/>
<area shape="rect" href="namespacesolvermodule.html#a1b92706b06bc176f7c61a0e3d4a427f1" title="Solves the ramp&#45;up stage, if any." alt="" coords="134,512,338,539"/>
</map>
</div>

</div>
</div>
<a id="a7c92134107339e8821b570b02170bd68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c92134107339e8821b570b02170bd68">&#9670;&nbsp;</a></span>iterationaccelerator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine solverroutinesmodule::iterationaccelerator </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>del</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>ierr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Accelerates the solution increment in case of line search. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iter</td><td>Iteration counter </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">res</td><td>Current force residual </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">del</td><td>Current solution increment </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ierr</td><td>Error flag</td></tr>
  </table>
  </dd>
</dl>
<p>The solution increment is scaled if the previous and current residual vectors are "almost" tangential, as are previous and current solution vectors (kind-of line search).</p>
<dl class="section author"><dt>Author</dt><dd>Bjorn Haugen</dd></dl>
<dl class="section date"><dt>Date</dt><dd>29 Mar 2002 </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolverroutinesmodule_a7c92134107339e8821b570b02170bd68_icgraph.png" border="0" usemap="#anamespacesolverroutinesmodule_a7c92134107339e8821b570b02170bd68_icgraph" alt=""/></div>
<map name="anamespacesolverroutinesmodule_a7c92134107339e8821b570b02170bd68_icgraph" id="anamespacesolverroutinesmodule_a7c92134107339e8821b570b02170bd68_icgraph">
<area shape="rect" title="Accelerates the solution increment in case of line search." alt="" coords="853,19,1017,60"/>
<area shape="rect" href="namespacenewmarkroutinesmodule.html#a4998597a0918626e80be5fcf91c40819" title="Advances the dynamics solution one step forward." alt="" coords="620,19,805,60"/>
<area shape="rect" href="namespacesolvermodule.html#a048f4879c526c74e1ae704bc1cf2dd48" title="Solves for the next time step or iteration." alt="" coords="389,26,572,53"/>
<area shape="rect" href="solverDriver_8f90.html#ac030f2d9c9b0bb0d9f6378bb2245cde8" title="Solves the next time increment by Newton&#45;Raphson iterations." alt="" coords="5,26,83,53"/>
<area shape="rect" href="namespaceinversemodule.html#a9502b109b6230e372fe609566135d17e" title=" " alt="" coords="131,26,341,53"/>
<area shape="rect" href="namespacesolvermodule.html#a1b92706b06bc176f7c61a0e3d4a427f1" title="Solves the ramp&#45;up stage, if any." alt="" coords="134,77,338,103"/>
</map>
</div>

</div>
</div>
<a id="a07c6727b5bc6cfb5d5614996cd11f5eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07c6727b5bc6cfb5d5614996cd11f5eb">&#9670;&nbsp;</a></span>printconvergence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine solverroutinesmodule::printconvergence </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>fileFormat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i8), intent(in)&#160;</td>
          <td class="paramname"><em>iStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>tanUpdate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>timeStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>del</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structnormtypemodule_1_1testsettype.html">testsettype</a>), intent(in)&#160;</td>
          <td class="paramname"><em>convData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structsammodule_1_1samtype.html">samtype</a>), intent(in)&#160;</td>
          <td class="paramname"><em>sam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmechanismtypemodule_1_1mechanismtype.html">mechanismtype</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mech</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints convergence information to the res-file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lpu</td><td>File unit number for res-file output </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fileFormat</td><td>File format option, &lt; 0 : old format (R4.0-compatible), = 0 : new format &gt; 0 : new format and write heading first </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iStep</td><td>Time increment counter </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iter</td><td>Iteration counter </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tanUpdate</td><td>If .true., a new tangent is computed in this iteration </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">time</td><td>Current simulation time </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timeStep</td><td>Time increment size </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">res</td><td>Force residual </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">del</td><td>Solution increment </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">convData</td><td>Iteration norm tolerances and values </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sam</td><td>Data for managing system matrix assembly </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mech</td><td>Mechanism components of the model</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Knut Morten Okstad</dd></dl>
<dl class="section date"><dt>Date</dt><dd>29 Jan 2004 </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolverroutinesmodule_a07c6727b5bc6cfb5d5614996cd11f5eb_cgraph.png" border="0" usemap="#anamespacesolverroutinesmodule_a07c6727b5bc6cfb5d5614996cd11f5eb_cgraph" alt=""/></div>
<map name="anamespacesolverroutinesmodule_a07c6727b5bc6cfb5d5614996cd11f5eb_cgraph" id="anamespacesolverroutinesmodule_a07c6727b5bc6cfb5d5614996cd11f5eb_cgraph">
<area shape="rect" title="Prints convergence information to the res&#45;file." alt="" coords="5,49,169,90"/>
<area shape="rect" href="namespacesammodule.html#a6fdab47d630a2d888453176403a65059" title="Returns internal node number and local dof&#45;number for a global dof." alt="" coords="217,5,467,32"/>
<area shape="rect" href="solverRoutinesModule_8f90.html#a8b107b3604a38889547790e06df78fd4" title="Writes the heading of the iteration norms." alt="" coords="268,56,416,83"/>
<area shape="rect" href="solverRoutinesModule_8f90.html#ab42b9b8b7a449841a4f22b7ec95e5b65" title="Writes the iteration norms values." alt="" coords="276,107,408,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolverroutinesmodule_a07c6727b5bc6cfb5d5614996cd11f5eb_icgraph.png" border="0" usemap="#anamespacesolverroutinesmodule_a07c6727b5bc6cfb5d5614996cd11f5eb_icgraph" alt=""/></div>
<map name="anamespacesolverroutinesmodule_a07c6727b5bc6cfb5d5614996cd11f5eb_icgraph" id="anamespacesolverroutinesmodule_a07c6727b5bc6cfb5d5614996cd11f5eb_icgraph">
<area shape="rect" title="Prints convergence information to the res&#45;file." alt="" coords="853,39,1017,80"/>
<area shape="rect" href="namespacenewmarkroutinesmodule.html#a4998597a0918626e80be5fcf91c40819" title="Advances the dynamics solution one step forward." alt="" coords="620,5,805,47"/>
<area shape="rect" href="namespacestaticequilibriummodule.html#aac6e8c83f3a0d690bf57832bf35012bf" title="Advances the quasi&#45;static solution one time step." alt="" coords="622,71,803,112"/>
<area shape="rect" href="namespacesolvermodule.html#a048f4879c526c74e1ae704bc1cf2dd48" title="Solves for the next time step or iteration." alt="" coords="389,46,572,73"/>
<area shape="rect" href="solverDriver_8f90.html#ac030f2d9c9b0bb0d9f6378bb2245cde8" title="Solves the next time increment by Newton&#45;Raphson iterations." alt="" coords="5,46,83,73"/>
<area shape="rect" href="namespaceinversemodule.html#a9502b109b6230e372fe609566135d17e" title=" " alt="" coords="131,46,341,73"/>
<area shape="rect" href="namespacesolvermodule.html#a1b92706b06bc176f7c61a0e3d4a427f1" title="Solves the ramp&#45;up stage, if any." alt="" coords="134,97,338,123"/>
</map>
</div>

</div>
</div>
<a id="a3eb8050e2ed46f4bdcbf7e87035244bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3eb8050e2ed46f4bdcbf7e87035244bf">&#9670;&nbsp;</a></span>printmassdistribution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine solverroutinesmodule::printmassdistribution </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structsupeltypemodule_1_1supeltype.html">supeltype</a>), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>sups</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmasstypemodule_1_1masstype.html">masstype</a>), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>masses</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structtiretypemodule_1_1tiretype.html">tiretype</a>), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>tires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structuserdefeltypemodule_1_1userdefeltype.html">userdefeltype</a>), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>elms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>gravity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(out)&#160;</td>
          <td class="paramname"><em>totMass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lpu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints a summary of the mass distribution to the res-file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sups</td><td>All superelements in the model </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">masses</td><td>All point masses in the model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tires</td><td>All tires in the model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">elms</td><td>All user-defined elements in the model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gravity</td><td>Gravitation vector </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">totMass</td><td>Total mass of the model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lpu</td><td>File unit number for res-file output</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Knut Morten Okstad</dd></dl>
<dl class="section date"><dt>Date</dt><dd>17 Apr 2002 </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolverroutinesmodule_a3eb8050e2ed46f4bdcbf7e87035244bf_cgraph.png" border="0" usemap="#anamespacesolverroutinesmodule_a3eb8050e2ed46f4bdcbf7e87035244bf_cgraph" alt=""/></div>
<map name="anamespacesolverroutinesmodule_a3eb8050e2ed46f4bdcbf7e87035244bf_cgraph" id="anamespacesolverroutinesmodule_a3eb8050e2ed46f4bdcbf7e87035244bf_cgraph">
<area shape="rect" title="Prints a summary of the mass distribution to the res&#45;file." alt="" coords="5,107,175,149"/>
<area shape="rect" href="solverRoutinesModule_8f90.html#a583a0e19208dcc2ef6c6e642fcbf9080" title="Sums up masses and CG for sub&#45;assemblies." alt="" coords="252,5,352,32"/>
<area shape="rect" href="solverRoutinesModule_8f90.html#aa1379af4bf3ffc1d5e7f2e6ea8fd6edd" title="Extracts equivalent mass in a given direction for a mass element." alt="" coords="263,56,341,83"/>
<area shape="rect" href="namespacescratcharraymodule.html#ae10f22e9df252a0c329b145347d2fc1f" title="Returns a pointer to a real(dp) scratch array." alt="" coords="223,107,381,149"/>
<area shape="rect" href="solverRoutinesModule_8f90.html#ad816e8da9c5d6ad720fb7549fea9cb09" title="Converts a 3x3 matrix into a second&#45;order tensor." alt="" coords="253,173,351,200"/>
<area shape="rect" href="namespacemassroutinesmodule.html#aa4eacbdd07f4fbd9c97724629e67ca55" title="Updates all mass elements." alt="" coords="223,225,381,266"/>
<area shape="rect" href="namespacemassroutinesmodule.html#a0be79f09e605f50e080cab9208a73c90" title="Updates a mass element." alt="" coords="429,225,588,266"/>
<area shape="rect" href="namespacemassroutinesmodule.html#a2be0f1e02ad8b4cbfbfc5796e7642fab" title="Calculates the gravitation forces for a mass element." alt="" coords="677,105,843,146"/>
<area shape="rect" href="namespacemassroutinesmodule.html#a1da11f704095558bbfd89fcd8aef6e0c" title="Calculates the inertia forces for a mass element." alt="" coords="681,187,839,229"/>
<area shape="rect" href="namespaceengineroutinesmodule.html#abde8ca534224a78120fd57630c2aad8a" title="Evaluates a general function." alt="" coords="676,275,844,317"/>
<area shape="rect" href="namespacetriadtypemodule.html#a2bf3201c49a85698dc70252d35f205bc" title="Updates the total nodal force vector associated with a triad." alt="" coords="636,341,884,368"/>
<area shape="rect" href="namespacetriadtypemodule.html#a132f15dec9190fe72da7c060ec487be4" title="Transforms a triad vector from global to triad directions." alt="" coords="932,103,1183,129"/>
<area shape="rect" href="FNVwaveForceModule_8f90.html#a9a0048950edd691805aa86cc576d4b18" title=" " alt="" coords="1001,204,1113,231"/>
<area shape="rect" href="namespacetriadtypemodule.html#abb08a33c88636f4ec2af07c4ddec7838" title="Transforms a triad vector from triad to global directions." alt="" coords="932,153,1183,180"/>
<area shape="rect" href="namespaceengineroutinesmodule.html#ae629adacbb32ecad9d122738343c5f83" title="Evaluates the argument(s) of a general function." alt="" coords="973,357,1141,398"/>
<area shape="rect" href="namespacefunctiontypemodule.html#a9e17d342b51a0fd0e8a0b1a110c75059" title="Evaluates the smooth trajectory ramp function." alt="" coords="1238,357,1391,398"/>
<area shape="rect" href="namespaceengineroutinesmodule.html#adeae596463a829024cd36a41499bd94a" title="Updates a sensor value depending on the sensor type." alt="" coords="1231,422,1399,463"/>
<area shape="rect" href="engineRoutinesModule_8f90.html#ab3fdff948eb505621ca2f6eaab5853cb" title="Evaluates a global rotation angle for given triad." alt="" coords="1529,532,1607,559"/>
<area shape="rect" href="engineRoutinesModule_8f90.html#a6e17874c5c197a1f4f24bec41453fee0" title="Evaluates a global force for given triad." alt="" coords="1510,583,1626,609"/>
<area shape="rect" href="engineRoutinesModule_8f90.html#af2e79733501f74c7bbf6ebce52f73e20" title="Evaluates a local velocity, acceleration or force for given triad." alt="" coords="1531,633,1605,660"/>
<area shape="rect" href="engineRoutinesModule_8f90.html#a1eb3c4dd66eeec5c9fb54c0facc49b23" title="Evaluates a relative quantity between given two triads." alt="" coords="1521,364,1615,391"/>
<area shape="rect" href="namespacehydrodynamicsmodule.html#ab23f3f782251450bff539a671b03298f" title="Evaluates the sea state at the given point and time." alt="" coords="1483,685,1653,726"/>
<area shape="rect" href="namespacewindturbineroutinesmodule.html#a738953d247d8f8b668a38100c94b743a" title=" " alt="" coords="1467,415,1669,457"/>
<area shape="rect" href="namespacetriadtypemodule.html#a69c00879f55aa87483ea1ecc0dbbb9e3" title="Transforms a triad vector from system to global directions." alt="" coords="1447,481,1689,508"/>
<area shape="rect" href="namespaceengineroutinesmodule.html#ae0205bdca764304fc089ed235b1e16bc" title="Updates the damper variables." alt="" coords="1484,298,1652,339"/>
<area shape="rect" href="namespaceengineroutinesmodule.html#aec312be90b47bc22894598dbf7fcd244" title="Updates the spring variables." alt="" coords="1484,233,1652,274"/>
<area shape="rect" href="namespacehydrodynamicsmodule.html#a44da9d3a4c902f379fe9075481880114" title="Evaluates the sea current velocity at the given point and time." alt="" coords="1779,923,1950,965"/>
<area shape="rect" href="namespacehydrodynamicsmodule.html#a9b42c0a097e0b2a5af861b10daa0a2a0" title="Evaluates the wave profile, velocity and acceleration at a point." alt="" coords="1779,669,1950,710"/>
<area shape="rect" href="hydroDynamicsModule_8f90.html#a25008eba1d21a1f3d49fabe077374659" title="Returns the function arguments depending on its dimensionality." alt="" coords="2091,981,2155,1008"/>
<area shape="rect" href="FNVwaveForceModule_8f90.html#a423ad348d400b7384ac2c56360de988d" title=" " alt="" coords="2085,931,2162,957"/>
<area shape="rect" href="namespacewavefunctionsmodule.html#acebfbf95e3a88840ff3fe41dda629647" title=" " alt="" coords="2040,342,2207,383"/>
<area shape="rect" href="namespacewavefunctionsmodule.html#a3c430e214eb5b3ec493b6497e09f8998" title=" " alt="" coords="2040,407,2207,449"/>
<area shape="rect" href="namespacewavefunctionsmodule.html#ae6675f30431fbeb5ee575addef577573" title=" " alt="" coords="2040,473,2207,514"/>
<area shape="rect" href="namespacewavefunctionsmodule.html#a409b2f382d9232e850cd7e45ff20e112" title=" " alt="" coords="2040,538,2207,579"/>
<area shape="rect" href="namespacewavefunctionsmodule.html#af083ce99d4b5b74b498641ac7a8831d7" title=" " alt="" coords="2040,603,2207,645"/>
<area shape="rect" href="namespacewavefunctionsmodule.html#a2dc8d3557051ab7af9072d329bcceb12" title=" " alt="" coords="2040,669,2207,710"/>
<area shape="rect" href="namespacewavefunctionsmodule.html#afabeafcb29815fdeac56558792aa3cc0" title=" " alt="" coords="2040,734,2207,775"/>
<area shape="rect" href="namespacewavefunctionsmodule.html#a5a9eb4c44dbc482bccb8c3d96924cbfb" title=" " alt="" coords="2040,799,2207,841"/>
<area shape="rect" href="namespacewavefunctionsmodule.html#a9536ea972bfe0f38fca26cf9d3776fa0" title=" " alt="" coords="2040,865,2207,906"/>
<area shape="rect" href="namespacedampertypemodule.html#a96a4a05cd6756c30dfc9885e46863fae" title="Evaluates the current damping coefficient for a damper." alt="" coords="1745,392,1985,419"/>
<area shape="rect" href="namespacedampertypemodule.html#a0c661b3d54ca99aaceed4a1accb18aad" title="Evaluates the current force for a damper." alt="" coords="1744,341,1985,368"/>
<area shape="rect" href="windTurbineRoutinesModule_8f90.html#a9054197eeb3116310ba964898ccae39b" title=" " alt="" coords="1837,291,1893,317"/>
<area shape="rect" href="namespacefunctiontypemodule.html#a85cca1a1e3200aa2ef5dabcbe26c6ec5" title="Integrates a function shape over specified domain." alt="" coords="2047,247,2200,289"/>
<area shape="rect" href="namespaceexplicitfunctionsmodule.html#aa35a6db770b90a9242369305ad21cfa0" title=" " alt="" coords="2255,247,2433,289"/>
<area shape="rect" href="namespacespringtypemodule.html#a51cf5243df27b1821816d0a4f0527700" title="Enforces the yield limits on current stiffness and force values." alt="" coords="1737,189,1992,216"/>
<area shape="rect" href="namespacespringtypemodule.html#a1aee6a5522fa8de073f083882d027b65" title="Evaluates the current force in a spring." alt="" coords="1754,240,1975,267"/>
<area shape="rect" href="namespacespringtypemodule.html#a36aa0726914f7bbdd270d55f0359f4ce" title="Evaluates the current stiffness in a spring." alt="" coords="1758,139,1971,165"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolverroutinesmodule_a3eb8050e2ed46f4bdcbf7e87035244bf_icgraph.png" border="0" usemap="#anamespacesolverroutinesmodule_a3eb8050e2ed46f4bdcbf7e87035244bf_icgraph" alt=""/></div>
<map name="anamespacesolverroutinesmodule_a3eb8050e2ed46f4bdcbf7e87035244bf_icgraph" id="anamespacesolverroutinesmodule_a3eb8050e2ed46f4bdcbf7e87035244bf_icgraph">
<area shape="rect" title="Prints a summary of the mass distribution to the res&#45;file." alt="" coords="353,99,523,141"/>
<area shape="rect" href="namespacesolvermodule.html#a98becc18e10e1c5bd8ac605048e0aebe" title="Initializes the simulation model." alt="" coords="131,107,305,133"/>
<area shape="rect" href="solverDriver_8f90.html#aa07e0fdca0c16c6bded8d8219dd3d3dc" title="Initializes a new simulation process." alt="" coords="5,5,83,32"/>
<area shape="rect" href="solverDriver_8f90.html#a28abf5f95b1e2d8dd4ae6c17f1f2d31a" title="Initializes a new simulation process." alt="" coords="5,56,83,83"/>
<area shape="rect" href="solverDriver_8f90.html#a43ba8eaac9f6ae5dd0a945584c31bf82" title="Initializes a new simulation process." alt="" coords="5,107,83,133"/>
<area shape="rect" href="solverDriver_8f90.html#a8e14233207067f1085bb7931cc1f7277" title="Initializes a new simulation process and restarts from provided state." alt="" coords="6,157,82,184"/>
<area shape="rect" href="solverDriver_8f90.html#abc8381a16b5750477e6f6c5e5f79acde" title="Initializes a new simulation process and restarts from provided state." alt="" coords="5,208,83,235"/>
</map>
</div>

</div>
</div>
<a id="af08eaa1ab32fc8aeae97e755e4355894"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af08eaa1ab32fc8aeae97e755e4355894">&#9670;&nbsp;</a></span>printresults()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine solverroutinesmodule::printresults </td>
          <td>(</td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structtriadtypemodule_1_1triadtype.html">triadtype</a>), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>triads</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structsupeltypemodule_1_1supeltype.html">supeltype</a>), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>sups</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iprint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lpu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints basic simulation variables to the res-file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">time</td><td>Current simulation time </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">triads</td><td>All triads in the model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sups</td><td>All superelements in the model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iprint</td><td>Print switch; the higher value the more print is produced </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lpu</td><td>File unit number for res-file output</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Knut Morten Okstad</dd></dl>
<dl class="section date"><dt>Date</dt><dd>18 Jun 2001 </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolverroutinesmodule_af08eaa1ab32fc8aeae97e755e4355894_icgraph.png" border="0" usemap="#anamespacesolverroutinesmodule_af08eaa1ab32fc8aeae97e755e4355894_icgraph" alt=""/></div>
<map name="anamespacesolverroutinesmodule_af08eaa1ab32fc8aeae97e755e4355894_icgraph" id="anamespacesolverroutinesmodule_af08eaa1ab32fc8aeae97e755e4355894_icgraph">
<area shape="rect" title="Prints basic simulation variables to the res&#45;file." alt="" coords="620,19,784,60"/>
<area shape="rect" href="namespacesolvermodule.html#a048f4879c526c74e1ae704bc1cf2dd48" title="Solves for the next time step or iteration." alt="" coords="389,26,572,53"/>
<area shape="rect" href="solverDriver_8f90.html#ac030f2d9c9b0bb0d9f6378bb2245cde8" title="Solves the next time increment by Newton&#45;Raphson iterations." alt="" coords="5,26,83,53"/>
<area shape="rect" href="namespaceinversemodule.html#a9502b109b6230e372fe609566135d17e" title=" " alt="" coords="131,26,341,53"/>
<area shape="rect" href="namespacesolvermodule.html#a1b92706b06bc176f7c61a0e3d4a427f1" title="Solves the ramp&#45;up stage, if any." alt="" coords="134,77,338,103"/>
</map>
</div>

</div>
</div>
<a id="af5ddd72d067b73dcf0a8e8f0cfd327c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5ddd72d067b73dcf0a8e8f0cfd327c5">&#9670;&nbsp;</a></span>restorelaststep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine solverroutinesmodule::restorelaststep </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structsammodule_1_1samtype.html">samtype</a>), intent(in)&#160;</td>
          <td class="paramname"><em>sam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structsystemtypemodule_1_1systemtype.html">systemtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>sys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmechanismtypemodule_1_1mechanismtype.html">mechanismtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>mech</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Restores all state variables from the last converged time step. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sam</td><td>Data for managing system matrix assembly </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">sys</td><td>System level model data </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">mech</td><td>Mechanism components of the model</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Knut Morten Okstad</dd></dl>
<dl class="section date"><dt>Date</dt><dd>Nov 2008 </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolverroutinesmodule_af5ddd72d067b73dcf0a8e8f0cfd327c5_icgraph.png" border="0" usemap="#anamespacesolverroutinesmodule_af5ddd72d067b73dcf0a8e8f0cfd327c5_icgraph" alt=""/></div>
<map name="anamespacesolverroutinesmodule_af5ddd72d067b73dcf0a8e8f0cfd327c5_icgraph" id="anamespacesolverroutinesmodule_af5ddd72d067b73dcf0a8e8f0cfd327c5_icgraph">
<area shape="rect" title="Restores all state variables from the last converged time step." alt="" coords="931,150,1095,191"/>
<area shape="rect" href="namespacesolvermodule.html#a48d19402ea9394b4475a02c69b642fba" title="Computes beam sectional forces for input displacements." alt="" coords="625,5,878,32"/>
<area shape="rect" href="namespacesolvermodule.html#a894f3f3cc83efce0f23873aab0cf920f" title="Computes strain tensor at gage positions for input displacements." alt="" coords="625,56,877,83"/>
<area shape="rect" href="namespacesolvermodule.html#a78a479ffd569dd6d0f66949a945ee112" title="Computes response variables for input displacements." alt="" coords="620,107,883,133"/>
<area shape="rect" href="newmarkRoutinesModule_8f90.html#a48d8765a345e041209d27c9648aef49e" title="Resets the current time and time step in case of cut&#45;back." alt="" coords="715,157,788,184"/>
<area shape="rect" href="namespacenewmarkroutinesmodule.html#a4998597a0918626e80be5fcf91c40819" title="Advances the dynamics solution one step forward." alt="" coords="659,209,844,250"/>
<area shape="rect" href="namespacefreqresponsemodule.html#ab724a650574c61985d742a7f0d21279c" title="Interface to the frequency&#45;domain solver module in Fedem." alt="" coords="158,333,314,374"/>
<area shape="rect" href="namespacestaticequilibriummodule.html#aac6e8c83f3a0d690bf57832bf35012bf" title="Advances the quasi&#45;static solution one time step." alt="" coords="661,274,842,315"/>
<area shape="rect" href="solverDriver_8f90.html#a66e8951bbb51b607396f1aa9355f2e5e" title="Calculates beam section forces for given displacement vector." alt="" coords="418,5,543,32"/>
<area shape="rect" href="solverDriver_8f90.html#ade0803ca952d384c462d887e06564c60" title="Calculates the strains at strain gages for a given displacement field." alt="" coords="425,56,537,83"/>
<area shape="rect" href="solverDriver_8f90.html#afa5e96a3d924478d75d69772fe1a9cbc" title="Calculates response variable values for given displacement vector." alt="" coords="413,107,548,133"/>
<area shape="rect" href="namespacesolvermodule.html#a048f4879c526c74e1ae704bc1cf2dd48" title="Solves for the next time step or iteration." alt="" coords="389,231,572,257"/>
<area shape="rect" href="solverDriver_8f90.html#ac030f2d9c9b0bb0d9f6378bb2245cde8" title="Solves the next time increment by Newton&#45;Raphson iterations." alt="" coords="5,281,83,308"/>
<area shape="rect" href="namespaceinversemodule.html#a9502b109b6230e372fe609566135d17e" title=" " alt="" coords="131,231,341,257"/>
<area shape="rect" href="namespacesolvermodule.html#a1b92706b06bc176f7c61a0e3d4a427f1" title="Solves the ramp&#45;up stage, if any." alt="" coords="134,281,338,308"/>
</map>
</div>

</div>
</div>
<a id="a7716799bcfc2860355c412a4ee3da400"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7716799bcfc2860355c412a4ee3da400">&#9670;&nbsp;</a></span>savestep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine solverroutinesmodule::savestep </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structsystemtypemodule_1_1systemtype.html">systemtype</a>), intent(in)&#160;</td>
          <td class="paramname"><em>sys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmechanismtypemodule_1_1mechanismtype.html">mechanismtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>mech</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcontroltypemodule_1_1controltype.html">controltype</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ctrl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>ierr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>checkTimeStep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Saves response variables of current time step to file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sys</td><td>System level model data </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">mech</td><td>Mechanism components of the model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctrl</td><td>Control system data </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ierr</td><td>Error flag </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">checkTimeStep</td><td>If present and .false., save the secondary variables for each time step (ignoring the -saveinc2 option).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Knut Morten Okstad</dd></dl>
<dl class="section date"><dt>Date</dt><dd>4 Jun 2002 </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolverroutinesmodule_a7716799bcfc2860355c412a4ee3da400_cgraph.png" border="0" usemap="#anamespacesolverroutinesmodule_a7716799bcfc2860355c412a4ee3da400_cgraph" alt=""/></div>
<map name="anamespacesolverroutinesmodule_a7716799bcfc2860355c412a4ee3da400_cgraph" id="anamespacesolverroutinesmodule_a7716799bcfc2860355c412a4ee3da400_cgraph">
<area shape="rect" title="Saves response variables of current time step to file." alt="" coords="5,895,169,936"/>
<area shape="rect" href="namespacewindturbineroutinesmodule.html#a1a8c29c3774d0bc146ba20cf1ad803b1" title=" " alt="" coords="226,451,427,492"/>
<area shape="rect" href="namespacewindturbineroutinesmodule.html#a1b07a429cb5103736c02e8730a66f680" title=" " alt="" coords="226,516,427,557"/>
<area shape="rect" href="namespacewindturbineroutinesmodule.html#a0739b31df558e955ec597b5a76d13065" title=" " alt="" coords="226,581,427,623"/>
<area shape="rect" href="namespacehydrodynamicsmodule.html#a6970d8c6fe6e6dcb973f3d6e30508472" title="Returns the wave height at the given point and time." alt="" coords="241,647,412,688"/>
<area shape="rect" href="namespacewindturbineroutinesmodule.html#a738953d247d8f8b668a38100c94b743a" title=" " alt="" coords="226,712,427,753"/>
<area shape="rect" href="namespacecontroltypemodule.html#a0ab21abe0427f8f9194d24479dde1770" title="Checks if control elements are present in the model." alt="" coords="250,777,403,819"/>
<area shape="rect" href="solverRoutinesModule_8f90.html#a7d45cb7776da258ac90d03d5880c611d" title="Convenience function checking if next step should be saved or not." alt="" coords="285,843,368,870"/>
<area shape="rect" href="namespacefiniteelementmodule.html#afab2aaa8333650efb83494cf14d80e63" title="Calculates the current beam sectional forces." alt="" coords="227,895,426,936"/>
<area shape="rect" href="namespaceengineroutinesmodule.html#a42e2b292c12fca80c6843a4a51f34310" title="Update all engines and store the values for saving." alt="" coords="239,960,414,1001"/>
<area shape="rect" href="namespacefiniteelementmodule.html#aba5abadd8b57f8f9b68b0d1c3276371d" title="Writes beam joint forces at current configuration to ASCII files." alt="" coords="242,1025,411,1067"/>
<area shape="rect" href="namespacecontroltypemodule.html#a23fa66555119dbc779a93733c49420cb" title="Writes control system data to the results database." alt="" coords="250,1359,403,1400"/>
<area shape="rect" href="namespacesavemodule.html#a8d6caebb54a58318d38ebc0019f40250" title="Administers writing of primary response results to database file." alt="" coords="223,1425,430,1451"/>
<area shape="rect" href="namespacesavemodule.html#ad712350ee862e5a2fb3ec295f3afd965" title="Administers writing of secondary response results to database file." alt="" coords="223,1091,430,1118"/>
<area shape="rect" href="namespacesavenastranmodule.html#a1ed8c9a551ee98618ce64675b68218fc" title=" " alt="" coords="247,1476,406,1517"/>
<area shape="rect" href="namespacesavevtfmodule.html#abdb90015b6ff49465596f16ac4fd7c6a" title=" " alt="" coords="217,1542,436,1569"/>
<area shape="rect" href="namespacehydrodynamicsmodule.html#a9b42c0a097e0b2a5af861b10daa0a2a0" title="Evaluates the wave profile, velocity and acceleration at a point." alt="" coords="516,332,687,373"/>
<area shape="rect" href="FNVwaveForceModule_8f90.html#a423ad348d400b7384ac2c56360de988d" title=" " alt="" coords="833,594,910,621"/>
<area shape="rect" href="namespacewavefunctionsmodule.html#acebfbf95e3a88840ff3fe41dda629647" title=" " alt="" coords="788,5,955,47"/>
<area shape="rect" href="namespacewavefunctionsmodule.html#a3c430e214eb5b3ec493b6497e09f8998" title=" " alt="" coords="788,71,955,112"/>
<area shape="rect" href="namespacewavefunctionsmodule.html#ae6675f30431fbeb5ee575addef577573" title=" " alt="" coords="788,136,955,177"/>
<area shape="rect" href="namespacewavefunctionsmodule.html#a409b2f382d9232e850cd7e45ff20e112" title=" " alt="" coords="788,201,955,243"/>
<area shape="rect" href="namespacewavefunctionsmodule.html#af083ce99d4b5b74b498641ac7a8831d7" title=" " alt="" coords="788,267,955,308"/>
<area shape="rect" href="namespacewavefunctionsmodule.html#a2dc8d3557051ab7af9072d329bcceb12" title=" " alt="" coords="788,332,955,373"/>
<area shape="rect" href="namespacewavefunctionsmodule.html#afabeafcb29815fdeac56558792aa3cc0" title=" " alt="" coords="788,397,955,439"/>
<area shape="rect" href="namespacewavefunctionsmodule.html#a5a9eb4c44dbc482bccb8c3d96924cbfb" title=" " alt="" coords="788,463,955,504"/>
<area shape="rect" href="namespacewavefunctionsmodule.html#a9536ea972bfe0f38fca26cf9d3776fa0" title=" " alt="" coords="788,528,955,569"/>
<area shape="rect" href="namespaceengineroutinesmodule.html#abde8ca534224a78120fd57630c2aad8a" title="Evaluates a general function." alt="" coords="517,645,685,687"/>
<area shape="rect" href="namespaceengineroutinesmodule.html#ae629adacbb32ecad9d122738343c5f83" title="Evaluates the argument(s) of a general function." alt="" coords="787,645,955,687"/>
<area shape="rect" href="namespacerdbmodule.html#a7850da2d310d0ef72199c2e73b87ab66" title="Checks that the estimated number of bytes per time is correct." alt="" coords="505,1370,697,1397"/>
<area shape="rect" href="controlTypeModule_8f90.html#af26c9eeacea49649746361505bba9d88" title="Writes an indexed integer array to io." alt="" coords="561,1471,641,1498"/>
<area shape="rect" href="controlTypeModule_8f90.html#a4ab885518fe71de6c745ebd57b2860dc" title="Writes an indexed real array to io." alt="" coords="561,1522,642,1549"/>
<area shape="rect" href="namespacerdbmodule.html#a6f21d1d878c1b0ac3880c21c23b214ff" title="Writes current time step to the specified results database file." alt="" coords="498,1421,705,1447"/>
<area shape="rect" href="namespacesavemodule.html#a76cb396d022a150fbab06292e064b695" title="Writes primary variables for a superelement to results database." alt="" coords="500,1573,703,1599"/>
<area shape="rect" href="namespacesavemodule.html#ad58e5556c7c36df8a6296247c9dbae44" title="Writes primary variables for a triad to results database." alt="" coords="503,1623,700,1650"/>
<area shape="rect" href="namespacesavemodule.html#ac308234b4edcc4843361ea9a31464f22" title="Writes results for a contact element to results database file." alt="" coords="498,813,705,839"/>
<area shape="rect" href="namespacesavemodule.html#a50b2575d49e88a11898eb9c4910a7112" title="Writes results for a damper to results database file." alt="" coords="767,762,976,789"/>
<area shape="rect" href="namespacesavemodule.html#a261efef4985e4b70e4f79ec04e88396f" title="Writes results for a spring to results database file." alt="" coords="772,914,971,941"/>
<area shape="rect" href="namespacesavemodule.html#a54671043cfcb8ddb199642aa5d6f2592" title="Writes results for the control system to results database file." alt="" coords="499,965,703,991"/>
<area shape="rect" href="namespacesavemodule.html#a04d8bb49cd0b1fb92ac54149d799cfde" title="Writes results for a general function to results database file." alt="" coords="500,1015,703,1042"/>
<area shape="rect" href="namespacesavemodule.html#a4b294208ab2bf3aca2a33959c2d2e881" title="Writes results for an external force to results database file." alt="" coords="505,1066,697,1093"/>
<area shape="rect" href="namespacesavemodule.html#a393c2282e10b82f77f487d77be6f2f12" title="Writes results for a joint to results database file." alt="" coords="507,863,695,890"/>
<area shape="rect" href="namespacesavemodule.html#a6732eb9342e222368d03eda3af11df05" title="Writes results for the mechanism to results database file." alt="" coords="484,1117,719,1143"/>
<area shape="rect" href="namespacesavemodule.html#af33344e67aa7c9b60a5cec3bdffe9738" title="Writes secondary variables for a superelement to results database." alt="" coords="500,1167,703,1194"/>
<area shape="rect" href="namespacesavemodule.html#a9fd7a0c2aee07b66895e514a67760a16" title="Writes results for a tire to results database file." alt="" coords="511,1218,692,1245"/>
<area shape="rect" href="namespacesavemodule.html#a7412afb02af924b1c8f3a02720450999" title="Writes secondary variables for a triad to results database." alt="" coords="503,1269,700,1295"/>
<area shape="rect" href="namespacesavemodule.html#a3e79e919bf601059516e503dc8299686" title="Writes some force variables for a triad to results database." alt="" coords="487,1319,716,1346"/>
<area shape="rect" href="namespacesavemodule.html#ae60319a2ca59157cea8200ede1d5814c" title="Writes results for a user&#45;defined element to results database file." alt="" coords="491,711,711,738"/>
<area shape="rect" href="namespacesavemodule.html#ae254eb85a426cf68f889d5db6ebd57f5" title="Writes results for a friction to results database file." alt="" coords="769,813,974,839"/>
<area shape="rect" href="saveModule_8f90.html#a70ea11dc4da6bf86de2cabae3665f05a" title="Writes a joint variable to the results database file." alt="" coords="811,863,932,890"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolverroutinesmodule_a7716799bcfc2860355c412a4ee3da400_icgraph.png" border="0" usemap="#anamespacesolverroutinesmodule_a7716799bcfc2860355c412a4ee3da400_icgraph" alt=""/></div>
<map name="anamespacesolverroutinesmodule_a7716799bcfc2860355c412a4ee3da400_icgraph" id="anamespacesolverroutinesmodule_a7716799bcfc2860355c412a4ee3da400_icgraph">
<area shape="rect" title="Saves response variables of current time step to file." alt="" coords="853,229,1017,270"/>
<area shape="rect" href="namespacesolvermodule.html#a98becc18e10e1c5bd8ac605048e0aebe" title="Initializes the simulation model." alt="" coords="393,112,568,139"/>
<area shape="rect" href="namespacenewmarkroutinesmodule.html#a4998597a0918626e80be5fcf91c40819" title="Advances the dynamics solution one step forward." alt="" coords="620,229,805,270"/>
<area shape="rect" href="namespacesolvermodule.html#a048f4879c526c74e1ae704bc1cf2dd48" title="Solves for the next time step or iteration." alt="" coords="389,300,572,327"/>
<area shape="rect" href="namespacestaticequilibriummodule.html#a0f1bc8d14ea2d090018de7485bf8a2ae" title="Performs static equilibrium iterations to find start configuration." alt="" coords="622,163,803,205"/>
<area shape="rect" href="namespacestaticequilibriummodule.html#aac6e8c83f3a0d690bf57832bf35012bf" title="Advances the quasi&#45;static solution one time step." alt="" coords="622,346,803,387"/>
<area shape="rect" href="solverDriver_8f90.html#aa07e0fdca0c16c6bded8d8219dd3d3dc" title="Initializes a new simulation process." alt="" coords="197,5,275,32"/>
<area shape="rect" href="solverDriver_8f90.html#a28abf5f95b1e2d8dd4ae6c17f1f2d31a" title="Initializes a new simulation process." alt="" coords="197,56,275,83"/>
<area shape="rect" href="solverDriver_8f90.html#a43ba8eaac9f6ae5dd0a945584c31bf82" title="Initializes a new simulation process." alt="" coords="197,107,275,133"/>
<area shape="rect" href="solverDriver_8f90.html#a8e14233207067f1085bb7931cc1f7277" title="Initializes a new simulation process and restarts from provided state." alt="" coords="198,157,274,184"/>
<area shape="rect" href="solverDriver_8f90.html#abc8381a16b5750477e6f6c5e5f79acde" title="Initializes a new simulation process and restarts from provided state." alt="" coords="197,208,275,235"/>
<area shape="rect" href="solverDriver_8f90.html#ac030f2d9c9b0bb0d9f6378bb2245cde8" title="Solves the next time increment by Newton&#45;Raphson iterations." alt="" coords="5,309,83,336"/>
<area shape="rect" href="namespaceinversemodule.html#a9502b109b6230e372fe609566135d17e" title=" " alt="" coords="131,309,341,336"/>
<area shape="rect" href="namespacesolvermodule.html#a1b92706b06bc176f7c61a0e3d4a427f1" title="Solves the ramp&#45;up stage, if any." alt="" coords="134,360,338,387"/>
</map>
</div>

</div>
</div>
<a id="a2e7d7fdcf7ac2ad0fb0d0ec9072ecb1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e7d7fdcf7ac2ad0fb0d0ec9072ecb1f">&#9670;&nbsp;</a></span>terminatestep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine solverroutinesmodule::terminatestep </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structsammodule_1_1samtype.html">samtype</a>), intent(in)&#160;</td>
          <td class="paramname"><em>sam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structsystemtypemodule_1_1systemtype.html">systemtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>sys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmechanismtypemodule_1_1mechanismtype.html">mechanismtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>mech</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcontroltypemodule_1_1controltype.html">controltype</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ctrl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>linearStatic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>finalStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>ierr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Terminates a time step by doing some final calculations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sam</td><td>Data for managing system matrix assembly </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">sys</td><td>System level model data </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">mech</td><td>Mechanism components of the model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctrl</td><td>Control system data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">linearStatic</td><td>If .true., we are doing a linear static analysis </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">finalStep</td><td>If .true., we have finished the final time step </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ierr</td><td>Error flag</td></tr>
  </table>
  </dd>
</dl>
<p>This subroutine performs some final calculations on the converged solution state, updates the previous state variables, etc.</p>
<dl class="section author"><dt>Author</dt><dd>Knut Morten Okstad</dd></dl>
<dl class="section date"><dt>Date</dt><dd>Sep 2000 </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolverroutinesmodule_a2e7d7fdcf7ac2ad0fb0d0ec9072ecb1f_cgraph.png" border="0" usemap="#anamespacesolverroutinesmodule_a2e7d7fdcf7ac2ad0fb0d0ec9072ecb1f_cgraph" alt=""/></div>
<map name="anamespacesolverroutinesmodule_a2e7d7fdcf7ac2ad0fb0d0ec9072ecb1f_cgraph" id="anamespacesolverroutinesmodule_a2e7d7fdcf7ac2ad0fb0d0ec9072ecb1f_cgraph">
<area shape="rect" title="Terminates a time step by doing some final calculations." alt="" coords="5,74,169,115"/>
<area shape="rect" href="namespacespringtypemodule.html#abc124f7b0f3dafa7ad3945f5df9a2c20" title="Checks for elastic unloading of cyclic plastic springs." alt="" coords="217,5,467,32"/>
<area shape="rect" href="namespacerotationmodule.html#a1074f5915042f7e80b4dd66a4e4e62b2" title="Makes a rotation tensor orthonormal through use of quaternions." alt="" coords="239,56,445,83"/>
<area shape="rect" href="namespacetimestepmodule.html#aeef6fe463ac0290ac10f160651333a74" title=" " alt="" coords="223,107,461,133"/>
<area shape="rect" href="namespacesolverroutinesmodule.html#a3680756ba4e87795f19474addfe247e6" title="Updates the previous state variables in the mechanism objects." alt="" coords="260,158,424,199"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolverroutinesmodule_a2e7d7fdcf7ac2ad0fb0d0ec9072ecb1f_icgraph.png" border="0" usemap="#anamespacesolverroutinesmodule_a2e7d7fdcf7ac2ad0fb0d0ec9072ecb1f_icgraph" alt=""/></div>
<map name="anamespacesolverroutinesmodule_a2e7d7fdcf7ac2ad0fb0d0ec9072ecb1f_icgraph" id="anamespacesolverroutinesmodule_a2e7d7fdcf7ac2ad0fb0d0ec9072ecb1f_icgraph">
<area shape="rect" title="Terminates a time step by doing some final calculations." alt="" coords="620,19,784,60"/>
<area shape="rect" href="namespacesolvermodule.html#a048f4879c526c74e1ae704bc1cf2dd48" title="Solves for the next time step or iteration." alt="" coords="389,26,572,53"/>
<area shape="rect" href="solverDriver_8f90.html#ac030f2d9c9b0bb0d9f6378bb2245cde8" title="Solves the next time increment by Newton&#45;Raphson iterations." alt="" coords="5,26,83,53"/>
<area shape="rect" href="namespaceinversemodule.html#a9502b109b6230e372fe609566135d17e" title=" " alt="" coords="131,26,341,53"/>
<area shape="rect" href="namespacesolvermodule.html#a1b92706b06bc176f7c61a0e3d4a427f1" title="Solves the ramp&#45;up stage, if any." alt="" coords="134,77,338,103"/>
</map>
</div>

</div>
</div>
<a id="a3680756ba4e87795f19474addfe247e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3680756ba4e87795f19474addfe247e6">&#9670;&nbsp;</a></span>updatepreviousstate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine solverroutinesmodule::updatepreviousstate </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structsammodule_1_1samtype.html">samtype</a>), intent(in)&#160;</td>
          <td class="paramname"><em>sam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structsystemtypemodule_1_1systemtype.html">systemtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>sys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmechanismtypemodule_1_1mechanismtype.html">mechanismtype</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>mech</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>ierr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the previous state variables in the mechanism objects. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sam</td><td>Data for managing system matrix assembly </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">sys</td><td>System level model data </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">mech</td><td>Mechanism components of the model </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ierr</td><td>Error flag</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Knut Morten Okstad</dd></dl>
<dl class="section date"><dt>Date</dt><dd>11 Aug 2023 </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacesolverroutinesmodule_a3680756ba4e87795f19474addfe247e6_icgraph.png" border="0" usemap="#anamespacesolverroutinesmodule_a3680756ba4e87795f19474addfe247e6_icgraph" alt=""/></div>
<map name="anamespacesolverroutinesmodule_a3680756ba4e87795f19474addfe247e6_icgraph" id="anamespacesolverroutinesmodule_a3680756ba4e87795f19474addfe247e6_icgraph">
<area shape="rect" title="Updates the previous state variables in the mechanism objects." alt="" coords="843,175,1007,217"/>
<area shape="rect" href="namespacesolvermodule.html#a98becc18e10e1c5bd8ac605048e0aebe" title="Initializes the simulation model." alt="" coords="620,132,795,159"/>
<area shape="rect" href="namespacesolverroutinesmodule.html#a2e7d7fdcf7ac2ad0fb0d0ec9072ecb1f" title="Terminates a time step by doing some final calculations." alt="" coords="625,205,789,246"/>
<area shape="rect" href="solverDriver_8f90.html#aa07e0fdca0c16c6bded8d8219dd3d3dc" title="Initializes a new simulation process." alt="" coords="442,5,519,32"/>
<area shape="rect" href="solverDriver_8f90.html#a28abf5f95b1e2d8dd4ae6c17f1f2d31a" title="Initializes a new simulation process." alt="" coords="442,56,519,83"/>
<area shape="rect" href="solverDriver_8f90.html#a43ba8eaac9f6ae5dd0a945584c31bf82" title="Initializes a new simulation process." alt="" coords="442,107,519,133"/>
<area shape="rect" href="solverDriver_8f90.html#a8e14233207067f1085bb7931cc1f7277" title="Initializes a new simulation process and restarts from provided state." alt="" coords="443,157,519,184"/>
<area shape="rect" href="solverDriver_8f90.html#abc8381a16b5750477e6f6c5e5f79acde" title="Initializes a new simulation process and restarts from provided state." alt="" coords="442,208,519,235"/>
<area shape="rect" href="namespacesolvermodule.html#a048f4879c526c74e1ae704bc1cf2dd48" title="Solves for the next time step or iteration." alt="" coords="389,259,572,285"/>
<area shape="rect" href="solverDriver_8f90.html#ac030f2d9c9b0bb0d9f6378bb2245cde8" title="Solves the next time increment by Newton&#45;Raphson iterations." alt="" coords="5,259,83,285"/>
<area shape="rect" href="namespaceinversemodule.html#a9502b109b6230e372fe609566135d17e" title=" " alt="" coords="131,259,341,285"/>
<area shape="rect" href="namespacesolvermodule.html#a1b92706b06bc176f7c61a0e3d4a427f1" title="Solves the ramp&#45;up stage, if any." alt="" coords="134,309,338,336"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ad345650407eb0d405ae52337c58d4fa5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad345650407eb0d405ae52337c58d4fa5">&#9670;&nbsp;</a></span>lastime</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(dp), dimension(4), save, private solverroutinesmodule::lastime = -1.0e99_dp</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Previous save times. </p>

</div>
</div>
<a id="a2a7bb7d79f8b0051469b04c07d4117cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a7bb7d79f8b0051469b04c07d4117cd">&#9670;&nbsp;</a></span>meqerr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(ik), dimension(:), allocatable, save solverroutinesmodule::meqerr</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>All singular equations found. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Oct 15 2025 14:36:58 for FEDEM Solver by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
