<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FEDEM Solver: felanczosmodule Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FEDEM Solver
   &#160;<span id="projectnumber">R8.0</span>
   </div>
   <div id="projectbrief">Source code of the dynamics solver</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">felanczosmodule Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Module with a Lanczos-based eigenvalue solver.  
<a href="namespacefelanczosmodule.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a4a64b51a5bc66dacc59450aa36b49c6c"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefelanczosmodule.html#a4a64b51a5bc66dacc59450aa36b49c6c">felanczossolve</a> (MsgA, structA, coeffA, factorA, MsgB, structB, coeffB, factorB, MPARB, MTREEB, MSIFB, valueB, diagB, TOL, EVL, EVC, MIP, MOP, N, NEVAL, NEVEC, MAXLAN, MSING, LPU, IPSW, INFO)</td></tr>
<tr class="memdesc:a4a64b51a5bc66dacc59450aa36b49c6c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solves a generalized symmetric eigenvalue problem.  <a href="namespacefelanczosmodule.html#a4a64b51a5bc66dacc59450aa36b49c6c">More...</a><br /></td></tr>
<tr class="separator:a4a64b51a5bc66dacc59450aa36b49c6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16d755206a68096b92814bef65bb12e5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefelanczosmodule.html#a16d755206a68096b92814bef65bb12e5">felfac</a> (INFO, LPU, KSA, KSB, KPD, N, NEVAL, EPS, NN, MSING, MsgA, structA, coeffA, factorA, MsgB, structB, coeffB, factorB, diagB, MPARB, MTREEB, MSIFB, valueB)</td></tr>
<tr class="memdesc:a16d755206a68096b92814bef65bb12e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Administers the matrix factorizations for the Lanczos eigensolver.  <a href="namespacefelanczosmodule.html#a16d755206a68096b92814bef65bb12e5">More...</a><br /></td></tr>
<tr class="separator:a16d755206a68096b92814bef65bb12e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04064783554a4abec1d42eadb9029550"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefelanczosmodule.html#a04064783554a4abec1d42eadb9029550">fefindandfixzeropivots</a> (struct, coeff, NZERO, MSING, INFO)</td></tr>
<tr class="memdesc:a04064783554a4abec1d42eadb9029550"><td class="mdescLeft">&#160;</td><td class="mdescRight">Repairs isolated zero pivot elements in the matrix.  <a href="namespacefelanczosmodule.html#a04064783554a4abec1d42eadb9029550">More...</a><br /></td></tr>
<tr class="separator:a04064783554a4abec1d42eadb9029550"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4443e6f46daec298e28eefcfba95426"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefelanczosmodule.html#af4443e6f46daec298e28eefcfba95426">fesmm</a> (INFO, LPU, IFLAG, Ndim, AllInt, X, Y, MsgA, structA, factorA, structB, coeffB, factorB, diagB, MPARB, MTREEB, MSIFB, valueB)</td></tr>
<tr class="memdesc:af4443e6f46daec298e28eefcfba95426"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs some linear algebra operations for the Lanczos eigensolver.  <a href="namespacefelanczosmodule.html#af4443e6f46daec298e28eefcfba95426">More...</a><br /></td></tr>
<tr class="separator:af4443e6f46daec298e28eefcfba95426"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab358fb1fd8851187c164e33d707bee9c"><td class="memItemLeft" align="right" valign="top">real(wp), dimension(:,:), allocatable, save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefelanczosmodule.html#ab358fb1fd8851187c164e33d707bee9c">work1</a></td></tr>
<tr class="memdesc:ab358fb1fd8851187c164e33d707bee9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal work array.  <a href="namespacefelanczosmodule.html#ab358fb1fd8851187c164e33d707bee9c">More...</a><br /></td></tr>
<tr class="separator:ab358fb1fd8851187c164e33d707bee9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53cf2c7bf7077516595c228f592c1790"><td class="memItemLeft" align="right" valign="top">real(wp), dimension(:,:), allocatable, save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefelanczosmodule.html#a53cf2c7bf7077516595c228f592c1790">work2</a></td></tr>
<tr class="memdesc:a53cf2c7bf7077516595c228f592c1790"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal work array.  <a href="namespacefelanczosmodule.html#a53cf2c7bf7077516595c228f592c1790">More...</a><br /></td></tr>
<tr class="separator:a53cf2c7bf7077516595c228f592c1790"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Module with a Lanczos-based eigenvalue solver. </p>
<p>This module contains subroutines implementing the Lanczos eigenvalue solver on top of the GSF linear equation solver. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a04064783554a4abec1d42eadb9029550"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04064783554a4abec1d42eadb9029550">&#9670;&nbsp;</a></span>fefindandfixzeropivots()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine felanczosmodule::fefindandfixzeropivots </td>
          <td>(</td>
          <td class="paramtype">type(sam), pointer&#160;</td>
          <td class="paramname"><em>struct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(cam), pointer&#160;</td>
          <td class="paramname"><em>coeff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>NZERO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(ik), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>MSING</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(error_flag), pointer&#160;</td>
          <td class="paramname"><em>INFO</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Repairs isolated zero pivot elements in the matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">struct</td><td>Symbolic assembly data for the matrix </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">coeff</td><td>Coefficient assembly data for the matrix </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">NZERO</td><td>Number of zero pivot elements in the matrix </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">MSING</td><td>Array of singular equations detected during factorization </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">INFO</td><td>Error handler object, nullified on success</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Knut Morten Okstad</dd></dl>
<dl class="section date"><dt>Date</dt><dd>20 Sep 2005 </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefelanczosmodule_a04064783554a4abec1d42eadb9029550_cgraph.png" border="0" usemap="#anamespacefelanczosmodule_a04064783554a4abec1d42eadb9029550_cgraph" alt=""/></div>
<map name="anamespacefelanczosmodule_a04064783554a4abec1d42eadb9029550_cgraph" id="anamespacefelanczosmodule_a04064783554a4abec1d42eadb9029550_cgraph">
<area shape="rect" title="Repairs isolated zero pivot elements in the matrix." alt="" coords="5,5,292,32"/>
<area shape="rect" href="feLanczosModule_8f90.html#afde83dc482aca940f2f1e6e0b2dda05d" title="Returns .true. if an error has been detected." alt="" coords="340,5,433,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefelanczosmodule_a04064783554a4abec1d42eadb9029550_icgraph.png" border="0" usemap="#anamespacefelanczosmodule_a04064783554a4abec1d42eadb9029550_icgraph" alt=""/></div>
<map name="anamespacefelanczosmodule_a04064783554a4abec1d42eadb9029550_icgraph" id="anamespacefelanczosmodule_a04064783554a4abec1d42eadb9029550_icgraph">
<area shape="rect" title="Repairs isolated zero pivot elements in the matrix." alt="" coords="1577,121,1864,148"/>
<area shape="rect" href="namespacefelanczosmodule.html#a16d755206a68096b92814bef65bb12e5" title="Administers the matrix factorizations for the Lanczos eigensolver." alt="" coords="1351,121,1529,148"/>
<area shape="rect" href="namespacefelanczosmodule.html#a4a64b51a5bc66dacc59450aa36b49c6c" title="Solves a generalized symmetric eigenvalue problem." alt="" coords="1064,121,1303,148"/>
<area shape="rect" href="namespacesolextensionmodule.html#a7acd8d2de76f49214c65649b864c473f" title="Solves the eigenvalue problem (A + λB) * u = 0." alt="" coords="852,114,1016,155"/>
<area shape="rect" href="namespacemodesroutinesmodule.html#a427a3c801ab9d700747fc7d40c7a4e0c" title="Calculate damped or undamped eigenvalues and eigenvectors." alt="" coords="636,85,804,126"/>
<area shape="rect" href="namespacecmstrsmodule.html#aabb37c12078bebda799a65a02816c11b" title="Solves the eigenvalue problem of the FE model." alt="" coords="639,151,801,177"/>
<area shape="rect" href="namespacesolvermodule.html#ac875f72daed4703cd8a24dc7b4908dc2" title="Solves the eigenvalue system at current configuration." alt="" coords="389,17,588,44"/>
<area shape="rect" href="namespacesolvermodule.html#a048f4879c526c74e1ae704bc1cf2dd48" title="Solves for the next time step or iteration." alt="" coords="397,93,580,120"/>
<area shape="rect" href="solverDriver_8f90.html#af00fbe28520a8c7e4bd1c6f066f71739" title="Solves the eigenvalue system at current configuration." alt="" coords="190,5,282,32"/>
<area shape="rect" href="solverDriver_8f90.html#ac030f2d9c9b0bb0d9f6378bb2245cde8" title="Solves the next time increment by Newton&#45;Raphson iterations." alt="" coords="5,107,83,133"/>
<area shape="rect" href="namespaceinversemodule.html#a9502b109b6230e372fe609566135d17e" title=" " alt="" coords="131,107,341,133"/>
<area shape="rect" href="namespacesolvermodule.html#a1b92706b06bc176f7c61a0e3d4a427f1" title="Solves the ramp&#45;up stage, if any." alt="" coords="134,157,338,184"/>
<area shape="rect" href="reducer_8f90.html#a9051040d0a60653a66c1af2bad11dfad" title="Main driver for the FEDEM FE part reducer." alt="" coords="453,148,524,175"/>
<area shape="rect" href="solver_8f90.html#ae09f6746388cd93c4d3f45a72214b200" title="Driver for the FEDEM linear FE part solver." alt="" coords="457,199,520,225"/>
</map>
</div>

</div>
</div>
<a id="a4a64b51a5bc66dacc59450aa36b49c6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a64b51a5bc66dacc59450aa36b49c6c">&#9670;&nbsp;</a></span>felanczossolve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public felanczosmodule::felanczossolve </td>
          <td>(</td>
          <td class="paramtype">type(messagelevel), pointer&#160;</td>
          <td class="paramname"><em>MsgA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(sam), pointer&#160;</td>
          <td class="paramname"><em>structA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(cam), pointer&#160;</td>
          <td class="paramname"><em>coeffA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(gsfcolsup), pointer&#160;</td>
          <td class="paramname"><em>factorA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(messagelevel), pointer&#160;</td>
          <td class="paramname"><em>MsgB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(sam), pointer&#160;</td>
          <td class="paramname"><em>structB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(cam), pointer&#160;</td>
          <td class="paramname"><em>coeffB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(gsfcolsup), pointer&#160;</td>
          <td class="paramname"><em>factorB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(ik), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>MPARB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(ik), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>MTREEB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(ik), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>MSIFB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), dimension(:), intent(inout), optional&#160;</td>
          <td class="paramname"><em>valueB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), dimension(:), intent(inout), optional&#160;</td>
          <td class="paramname"><em>diagB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), dimension(3), intent(inout)&#160;</td>
          <td class="paramname"><em>TOL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>EVL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>EVC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(ik), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>MIP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(ik), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>MOP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NEVAL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NEVEC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>MAXLAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(ik), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>MSING</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>LPU</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>IPSW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(error_flag), pointer&#160;</td>
          <td class="paramname"><em>INFO</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solves a generalized symmetric eigenvalue problem. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">MsgA</td><td>GSF information for matrix <b>A</b> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">MsgB</td><td>GSF information for matrix <b>B</b> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">structA</td><td>Symbolic assembly data for matrix <b>A</b> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">structB</td><td>Symbolic assembly data for matrix <b>B</b> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">coeffA</td><td>Coefficient assembly data for matrix <b>A</b> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">coeffB</td><td>Coefficient assembly data for matrix <b>B</b> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">factorA</td><td>Factorization data for matrix <b>A</b> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">factorB</td><td>Factorization data for matrix <b>B</b> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MPARB</td><td>Sparse PARameters for SPR-matrix <b>B</b> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MTREEB</td><td>Elimination assembly TREES for SPR-matrix <b>B</b> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MSIFB</td><td>Storage Information for SPR-matrix <b>B</b> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">valueB</td><td>Matrix values for SPR-matrix <b>B</b> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">diagB</td><td>The diagonal values for SPR-matrix <b>B</b> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">TOL</td><td>Tolerances </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">EVL</td><td>Computed eigenvalues </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">EVC</td><td>Computed eigenvectors </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MIP</td><td>Input options </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td>Dimension of the equation system </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NEVAL</td><td>Number of eigenvalues to return </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NEVEC</td><td>Number of eigenvectors to return </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MAXLAN</td><td>Maximum number of Lanczos vectors </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LPU</td><td>File unit number for res-file output </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IPSW</td><td>Print switch for debug output </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">MOP</td><td>Output options </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">MSING</td><td>Array of singular equations detected during factorization </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">INFO</td><td>Error handler object, nullified on success</td></tr>
  </table>
  </dd>
</dl>
<p>This subroutine determines the <em>NEVAL</em> smallest eigenvalues &lambda;<sub>i</sub> of the generalized, symmetric eigenproblem</p>
<p>(<b>A</b> - &lambda;<sub>i</sub>*<b>B</b>) * <b>q</b><sub>i</sub> = 0</p>
<p>The routine also returns <em>NLV</em> (=MOP(3)) ortogonal Lanczos vectors or, optionally, approximations to <em>NEVEC</em> eigenvectors (corresponding to the <em>NEVEC</em> first eigenvalues). The eigenvectors, which are B-orthonormal, are returned as the first <em>NEVEC</em> vectors in <em>EVC</em>.</p>
<p><b>A</b> is a symmetric matrix stored in sparse (compressed) format. <b>B</b> is either a symmetric sparse (KSB=1) or a diagonal (KSB=2) matrix. For both <b>A</b> and <b>B</b> the original matrices or their appropriate factors are accepted as input (in coeffA/factorA and coeffB/factorB). A truncated Lanczos method is used to transform the problem to tridiagonal, special form. The reduced, tridiagonal eigenproblem is solved by implicit QL transformation. Various reorthogonalization schemes may be specified.</p>
<p>This is the GSF version of the SPRLAN subroutine of the SAM library. The matrix <b>B</b> may optionally be represented by an SPR data structure, when <em>KSB</em> = MIP(2) = 3.</p>
<dl class="section author"><dt>Author</dt><dd>Knut Morten Okstad</dd></dl>
<dl class="section date"><dt>Date</dt><dd>12 May 2005 </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefelanczosmodule_a4a64b51a5bc66dacc59450aa36b49c6c_cgraph.png" border="0" usemap="#anamespacefelanczosmodule_a4a64b51a5bc66dacc59450aa36b49c6c_cgraph" alt=""/></div>
<map name="anamespacefelanczosmodule_a4a64b51a5bc66dacc59450aa36b49c6c_cgraph" id="anamespacefelanczosmodule_a4a64b51a5bc66dacc59450aa36b49c6c_cgraph">
<area shape="rect" title="Solves a generalized symmetric eigenvalue problem." alt="" coords="5,107,244,133"/>
<area shape="rect" href="namespacefelanczosmodule.html#a16d755206a68096b92814bef65bb12e5" title="Administers the matrix factorizations for the Lanczos eigensolver." alt="" coords="296,5,475,32"/>
<area shape="rect" href="feLanczosModule_8f90.html#a831f43b604054ae2c90367cdd5dc7173" title="Fortran90&#45;version of the SAM subroutine MGSOR1." alt="" coords="341,56,430,83"/>
<area shape="rect" href="feLanczosModule_8f90.html#aac6249bfadd3022a77c172e012d7d111" title="Fortran90&#45;version of the SAM subroutine RANVEC (generation of a pseudo&#45;random vector)." alt="" coords="331,107,439,133"/>
<area shape="rect" href="feLanczosModule_8f90.html#aa4843dd1ecac1745e947c27b2c17bddd" title="Fortran90&#45;version of the SAM subroutine REORL2." alt="" coords="353,157,418,184"/>
<area shape="rect" href="namespacefelanczosmodule.html#af4443e6f46daec298e28eefcfba95426" title="Performs some linear algebra operations for the Lanczos eigensolver." alt="" coords="292,208,479,235"/>
<area shape="rect" href="namespacefelanczosmodule.html#a04064783554a4abec1d42eadb9029550" title="Repairs isolated zero pivot elements in the matrix." alt="" coords="527,5,813,32"/>
<area shape="rect" href="feLanczosModule_8f90.html#afde83dc482aca940f2f1e6e0b2dda05d" title="Returns .true. if an error has been detected." alt="" coords="861,5,955,32"/>
<area shape="rect" href="feLanczosModule_8f90.html#a88ba469c5166ecd6654f416b709760ea" title="Returns a matrix pointer to an array." alt="" coords="597,208,743,235"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefelanczosmodule_a4a64b51a5bc66dacc59450aa36b49c6c_icgraph.png" border="0" usemap="#anamespacefelanczosmodule_a4a64b51a5bc66dacc59450aa36b49c6c_icgraph" alt=""/></div>
<map name="anamespacefelanczosmodule_a4a64b51a5bc66dacc59450aa36b49c6c_icgraph" id="anamespacefelanczosmodule_a4a64b51a5bc66dacc59450aa36b49c6c_icgraph">
<area shape="rect" title="Solves a generalized symmetric eigenvalue problem." alt="" coords="1064,121,1303,148"/>
<area shape="rect" href="namespacesolextensionmodule.html#a7acd8d2de76f49214c65649b864c473f" title="Solves the eigenvalue problem (A + λB) * u = 0." alt="" coords="852,114,1016,155"/>
<area shape="rect" href="namespacemodesroutinesmodule.html#a427a3c801ab9d700747fc7d40c7a4e0c" title="Calculate damped or undamped eigenvalues and eigenvectors." alt="" coords="636,85,804,126"/>
<area shape="rect" href="namespacecmstrsmodule.html#aabb37c12078bebda799a65a02816c11b" title="Solves the eigenvalue problem of the FE model." alt="" coords="639,151,801,177"/>
<area shape="rect" href="namespacesolvermodule.html#ac875f72daed4703cd8a24dc7b4908dc2" title="Solves the eigenvalue system at current configuration." alt="" coords="389,17,588,44"/>
<area shape="rect" href="namespacesolvermodule.html#a048f4879c526c74e1ae704bc1cf2dd48" title="Solves for the next time step or iteration." alt="" coords="397,93,580,120"/>
<area shape="rect" href="solverDriver_8f90.html#af00fbe28520a8c7e4bd1c6f066f71739" title="Solves the eigenvalue system at current configuration." alt="" coords="190,5,282,32"/>
<area shape="rect" href="solverDriver_8f90.html#ac030f2d9c9b0bb0d9f6378bb2245cde8" title="Solves the next time increment by Newton&#45;Raphson iterations." alt="" coords="5,107,83,133"/>
<area shape="rect" href="namespaceinversemodule.html#a9502b109b6230e372fe609566135d17e" title=" " alt="" coords="131,107,341,133"/>
<area shape="rect" href="namespacesolvermodule.html#a1b92706b06bc176f7c61a0e3d4a427f1" title="Solves the ramp&#45;up stage, if any." alt="" coords="134,157,338,184"/>
<area shape="rect" href="reducer_8f90.html#a9051040d0a60653a66c1af2bad11dfad" title="Main driver for the FEDEM FE part reducer." alt="" coords="453,148,524,175"/>
<area shape="rect" href="solver_8f90.html#ae09f6746388cd93c4d3f45a72214b200" title="Driver for the FEDEM linear FE part solver." alt="" coords="457,199,520,225"/>
</map>
</div>

</div>
</div>
<a id="a16d755206a68096b92814bef65bb12e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16d755206a68096b92814bef65bb12e5">&#9670;&nbsp;</a></span>felfac()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine felanczosmodule::felfac </td>
          <td>(</td>
          <td class="paramtype">type(error_flag), pointer&#160;</td>
          <td class="paramname"><em>INFO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>LPU</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(ik), intent(inout)&#160;</td>
          <td class="paramname"><em>KSA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(ik), intent(inout)&#160;</td>
          <td class="paramname"><em>KSB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>KPD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NEVAL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>EPS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(ik), intent(out)&#160;</td>
          <td class="paramname"><em>NN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(ik), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>MSING</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(messagelevel), pointer&#160;</td>
          <td class="paramname"><em>MsgA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(sam), pointer&#160;</td>
          <td class="paramname"><em>structA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(cam), pointer&#160;</td>
          <td class="paramname"><em>coeffA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(gsfcolsup), pointer&#160;</td>
          <td class="paramname"><em>factorA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(messagelevel), pointer&#160;</td>
          <td class="paramname"><em>MsgB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(sam), pointer&#160;</td>
          <td class="paramname"><em>structB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(cam), pointer&#160;</td>
          <td class="paramname"><em>coeffB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(gsfcolsup), pointer&#160;</td>
          <td class="paramname"><em>factorB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), dimension(:), intent(inout), optional&#160;</td>
          <td class="paramname"><em>diagB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(ik), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>MPARB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(ik), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>MTREEB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(ik), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>MSIFB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), dimension(:), intent(inout), optional&#160;</td>
          <td class="paramname"><em>valueB</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Administers the matrix factorizations for the Lanczos eigensolver. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">INFO</td><td>Error handler object, nullified on success </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LPU</td><td>File unit number for res-file output </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">KSA</td><td>Factorization option for matrix <b>A</b> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">KSB</td><td>Factorization option for matrix <b>B</b> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">KPD</td><td>Factorization option </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td>Dimension of the equation system </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NEVAL</td><td>Number of eigenvalues to return </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">EPS</td><td>Singularity tolerance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NN</td><td>Number of singular equations when <b>B</b> is diagonal </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">MSING</td><td>Array of singular equations detected during factorization </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">MsgA</td><td>GSF information for matrix <b>A</b> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">structA</td><td>Symbolic assembly data for matrix <b>A</b> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">coeffA</td><td>Coefficient assembly data for matrix <b>A</b> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">factorA</td><td>Factorization data for matrix <b>A</b> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">MsgB</td><td>GSF information for matrix <b>B</b> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">structB</td><td>Symbolic assembly data for matrix <b>B</b> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">coeffB</td><td>Coefficient assembly data for matrix <b>B</b> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">factorB</td><td>Factorization data for matrix <b>B</b> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">diagB</td><td>The diagonal values for SPR-matrix <b>B</b> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MPARB</td><td>Sparse PARameters for SPR-matrix <b>B</b> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MTREEB</td><td>Elimination assembly TREES for SPR-matrix <b>B</b> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MSIFB</td><td>Storage Information for SPR-matrix <b>B</b> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">valueB</td><td>Matrix values for SPR-matrix <b>B</b> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Knut Morten Okstad</dd></dl>
<dl class="section date"><dt>Date</dt><dd>12 May 2005 </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefelanczosmodule_a16d755206a68096b92814bef65bb12e5_cgraph.png" border="0" usemap="#anamespacefelanczosmodule_a16d755206a68096b92814bef65bb12e5_cgraph" alt=""/></div>
<map name="anamespacefelanczosmodule_a16d755206a68096b92814bef65bb12e5_cgraph" id="anamespacefelanczosmodule_a16d755206a68096b92814bef65bb12e5_cgraph">
<area shape="rect" title="Administers the matrix factorizations for the Lanczos eigensolver." alt="" coords="5,5,184,32"/>
<area shape="rect" href="namespacefelanczosmodule.html#a04064783554a4abec1d42eadb9029550" title="Repairs isolated zero pivot elements in the matrix." alt="" coords="232,5,519,32"/>
<area shape="rect" href="feLanczosModule_8f90.html#afde83dc482aca940f2f1e6e0b2dda05d" title="Returns .true. if an error has been detected." alt="" coords="567,5,660,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefelanczosmodule_a16d755206a68096b92814bef65bb12e5_icgraph.png" border="0" usemap="#anamespacefelanczosmodule_a16d755206a68096b92814bef65bb12e5_icgraph" alt=""/></div>
<map name="anamespacefelanczosmodule_a16d755206a68096b92814bef65bb12e5_icgraph" id="anamespacefelanczosmodule_a16d755206a68096b92814bef65bb12e5_icgraph">
<area shape="rect" title="Administers the matrix factorizations for the Lanczos eigensolver." alt="" coords="1351,121,1529,148"/>
<area shape="rect" href="namespacefelanczosmodule.html#a4a64b51a5bc66dacc59450aa36b49c6c" title="Solves a generalized symmetric eigenvalue problem." alt="" coords="1064,121,1303,148"/>
<area shape="rect" href="namespacesolextensionmodule.html#a7acd8d2de76f49214c65649b864c473f" title="Solves the eigenvalue problem (A + λB) * u = 0." alt="" coords="852,114,1016,155"/>
<area shape="rect" href="namespacemodesroutinesmodule.html#a427a3c801ab9d700747fc7d40c7a4e0c" title="Calculate damped or undamped eigenvalues and eigenvectors." alt="" coords="636,85,804,126"/>
<area shape="rect" href="namespacecmstrsmodule.html#aabb37c12078bebda799a65a02816c11b" title="Solves the eigenvalue problem of the FE model." alt="" coords="639,151,801,177"/>
<area shape="rect" href="namespacesolvermodule.html#ac875f72daed4703cd8a24dc7b4908dc2" title="Solves the eigenvalue system at current configuration." alt="" coords="389,17,588,44"/>
<area shape="rect" href="namespacesolvermodule.html#a048f4879c526c74e1ae704bc1cf2dd48" title="Solves for the next time step or iteration." alt="" coords="397,93,580,120"/>
<area shape="rect" href="solverDriver_8f90.html#af00fbe28520a8c7e4bd1c6f066f71739" title="Solves the eigenvalue system at current configuration." alt="" coords="190,5,282,32"/>
<area shape="rect" href="solverDriver_8f90.html#ac030f2d9c9b0bb0d9f6378bb2245cde8" title="Solves the next time increment by Newton&#45;Raphson iterations." alt="" coords="5,107,83,133"/>
<area shape="rect" href="namespaceinversemodule.html#a9502b109b6230e372fe609566135d17e" title=" " alt="" coords="131,107,341,133"/>
<area shape="rect" href="namespacesolvermodule.html#a1b92706b06bc176f7c61a0e3d4a427f1" title="Solves the ramp&#45;up stage, if any." alt="" coords="134,157,338,184"/>
<area shape="rect" href="reducer_8f90.html#a9051040d0a60653a66c1af2bad11dfad" title="Main driver for the FEDEM FE part reducer." alt="" coords="453,148,524,175"/>
<area shape="rect" href="solver_8f90.html#ae09f6746388cd93c4d3f45a72214b200" title="Driver for the FEDEM linear FE part solver." alt="" coords="457,199,520,225"/>
</map>
</div>

</div>
</div>
<a id="af4443e6f46daec298e28eefcfba95426"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4443e6f46daec298e28eefcfba95426">&#9670;&nbsp;</a></span>fesmm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine felanczosmodule::fesmm </td>
          <td>(</td>
          <td class="paramtype">type(error_flag), pointer&#160;</td>
          <td class="paramname"><em>INFO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>LPU</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>IFLAG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>Ndim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=1), intent(in)&#160;</td>
          <td class="paramname"><em>AllInt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(messagelevel), pointer&#160;</td>
          <td class="paramname"><em>MsgA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(sam), pointer&#160;</td>
          <td class="paramname"><em>structA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(gsfcolsup), pointer&#160;</td>
          <td class="paramname"><em>factorA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(sam), optional, pointer&#160;</td>
          <td class="paramname"><em>structB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(cam), optional, pointer&#160;</td>
          <td class="paramname"><em>coeffB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(gsfcolsup), optional, pointer&#160;</td>
          <td class="paramname"><em>factorB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>diagB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(ik), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>MPARB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(ik), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>MTREEB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(ik), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>MSIFB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>valueB</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Performs some linear algebra operations for the Lanczos eigensolver. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">INFO</td><td>Error handler object, nullified on success </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LPU</td><td>File unit number for res-file output </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IFLAG</td><td>Option telling which operation to perform (see below) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Ndim</td><td>Dimension of the equation system </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">AllInt</td><td>If 'A', use full matrix, if 'I' use internal DOFs only </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">X</td><td>Vector of dimension <em>Ndim</em> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Y</td><td>Vector of dimension <em>Ndim</em> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">MsgA</td><td>GSF information for matrix <b>A</b> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">structA</td><td>Symbolic assembly data for matrix <b>A</b> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">factorA</td><td>Factorization data for matrix <b>A</b> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">structB</td><td>Symbolic assembly data for matrix <b>B</b> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">coeffB</td><td>Coefficient assembly data for matrix <b>B</b> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">factorB</td><td>Factorization data for matrix <b>B</b> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">diagB</td><td>The diagonal values for SPR-matrix <b>B</b> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MPARB</td><td>Sparse PARameters for SPR-matrix <b>B</b> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MTREEB</td><td>Elimination assembly TREES for SPR-matrix <b>B</b> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MSIFB</td><td>Storage Information for SPR-matrix <b>B</b> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">valueB</td><td>Matrix values for SPR-matrix <b>B</b> </td></tr>
  </table>
  </dd>
</dl>
<p>This subroutine calculates one of the following:</p>
<ul>
<li>IFLAG = 1: X := (A-1)*UbT*X</li>
<li>IFLAG = 2: Y = (A-1)*UbT*X</li>
<li>IFLAG = 3: X := Ub*(A-1)*UbT*X</li>
<li>IFLAG = 4: Y = Ub*(A-1)*UbT*X</li>
<li>IFLAG = 5: X := (Ua-T)*B*(Ua-1)*X</li>
<li>IFLAG = 6: Y = (Ua-T)*B*(Ua-1)*X</li>
</ul>
<p>where <b>X</b> and <b>Y</b> are vectors, <b>A</b> is a symmetric sparse matrix, represented by its factors <em>La*Da*LaT</em>, stored in <em>structA</em> and <em>factorA</em>, <em>Ua</em> is the Cholesky factor of <b>A</b>, also stored in <em>structA</em>,factorA, <b>B</b> is either a symmetric sparse matrix, stored in <em>structB</em>,coeffB, a symmetric sparse in-core matrix, stored in <em>MPARB</em>, ..., <em>valueB</em>, or a diagonal matrix, stored in <em>diagB</em>. <em>Ub</em> is the Cholesky factor of <b>B</b>, stored in <em>structB</em>,factorB or in <em>MPARB</em>, ..., <em>valueB</em>, or in <em>diagB</em> if <b>B</b> is just a diagonal matrix.</p>
<dl class="section author"><dt>Author</dt><dd>Knut Morten Okstad</dd></dl>
<dl class="section date"><dt>Date</dt><dd>12 May 2005 </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefelanczosmodule_af4443e6f46daec298e28eefcfba95426_cgraph.png" border="0" usemap="#anamespacefelanczosmodule_af4443e6f46daec298e28eefcfba95426_cgraph" alt=""/></div>
<map name="anamespacefelanczosmodule_af4443e6f46daec298e28eefcfba95426_cgraph" id="anamespacefelanczosmodule_af4443e6f46daec298e28eefcfba95426_cgraph">
<area shape="rect" title="Performs some linear algebra operations for the Lanczos eigensolver." alt="" coords="5,5,192,32"/>
<area shape="rect" href="feLanczosModule_8f90.html#a88ba469c5166ecd6654f416b709760ea" title="Returns a matrix pointer to an array." alt="" coords="240,5,385,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefelanczosmodule_af4443e6f46daec298e28eefcfba95426_icgraph.png" border="0" usemap="#anamespacefelanczosmodule_af4443e6f46daec298e28eefcfba95426_icgraph" alt=""/></div>
<map name="anamespacefelanczosmodule_af4443e6f46daec298e28eefcfba95426_icgraph" id="anamespacefelanczosmodule_af4443e6f46daec298e28eefcfba95426_icgraph">
<area shape="rect" title="Performs some linear algebra operations for the Lanczos eigensolver." alt="" coords="1351,121,1537,148"/>
<area shape="rect" href="namespacefelanczosmodule.html#a4a64b51a5bc66dacc59450aa36b49c6c" title="Solves a generalized symmetric eigenvalue problem." alt="" coords="1064,121,1303,148"/>
<area shape="rect" href="namespacesolextensionmodule.html#a7acd8d2de76f49214c65649b864c473f" title="Solves the eigenvalue problem (A + λB) * u = 0." alt="" coords="852,114,1016,155"/>
<area shape="rect" href="namespacemodesroutinesmodule.html#a427a3c801ab9d700747fc7d40c7a4e0c" title="Calculate damped or undamped eigenvalues and eigenvectors." alt="" coords="636,85,804,126"/>
<area shape="rect" href="namespacecmstrsmodule.html#aabb37c12078bebda799a65a02816c11b" title="Solves the eigenvalue problem of the FE model." alt="" coords="639,151,801,177"/>
<area shape="rect" href="namespacesolvermodule.html#ac875f72daed4703cd8a24dc7b4908dc2" title="Solves the eigenvalue system at current configuration." alt="" coords="389,17,588,44"/>
<area shape="rect" href="namespacesolvermodule.html#a048f4879c526c74e1ae704bc1cf2dd48" title="Solves for the next time step or iteration." alt="" coords="397,93,580,120"/>
<area shape="rect" href="solverDriver_8f90.html#af00fbe28520a8c7e4bd1c6f066f71739" title="Solves the eigenvalue system at current configuration." alt="" coords="190,5,282,32"/>
<area shape="rect" href="solverDriver_8f90.html#ac030f2d9c9b0bb0d9f6378bb2245cde8" title="Solves the next time increment by Newton&#45;Raphson iterations." alt="" coords="5,107,83,133"/>
<area shape="rect" href="namespaceinversemodule.html#a9502b109b6230e372fe609566135d17e" title=" " alt="" coords="131,107,341,133"/>
<area shape="rect" href="namespacesolvermodule.html#a1b92706b06bc176f7c61a0e3d4a427f1" title="Solves the ramp&#45;up stage, if any." alt="" coords="134,157,338,184"/>
<area shape="rect" href="reducer_8f90.html#a9051040d0a60653a66c1af2bad11dfad" title="Main driver for the FEDEM FE part reducer." alt="" coords="453,148,524,175"/>
<area shape="rect" href="solver_8f90.html#ae09f6746388cd93c4d3f45a72214b200" title="Driver for the FEDEM linear FE part solver." alt="" coords="457,199,520,225"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ab358fb1fd8851187c164e33d707bee9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab358fb1fd8851187c164e33d707bee9c">&#9670;&nbsp;</a></span>work1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(wp), dimension(:,:), allocatable, save felanczosmodule::work1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Internal work array. </p>

</div>
</div>
<a id="a53cf2c7bf7077516595c228f592c1790"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53cf2c7bf7077516595c228f592c1790">&#9670;&nbsp;</a></span>work2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(wp), dimension(:,:), allocatable, save felanczosmodule::work2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Internal work array. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Feb 15 2026 16:34:01 for FEDEM Solver by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
