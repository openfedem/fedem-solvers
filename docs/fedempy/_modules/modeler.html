

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>modeler &mdash; fedempy 3.9.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=4122dfff"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            fedempy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../howtos.html">fedempy HOWTO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">fedempy modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dts_operators.html">dts_operators module</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">fedempy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">modeler</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for modeler</h1><div class="highlight"><pre>
<span></span><span class="c1"># SPDX-FileCopyrightText: 2023 SAP SE</span>
<span class="c1">#</span>
<span class="c1"># SPDX-License-Identifier: Apache-2.0</span>
<span class="c1">#</span>
<span class="c1"># This file is part of FEDEM - https://openfedem.org</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Python wrapper for the native fedem modeler.</span>

<span class="sd">This module provides functionality for creating new Fedem models,</span>
<span class="sd">and for modifying existing ones.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">ctypes</span><span class="w"> </span><span class="kn">import</span> <span class="n">POINTER</span><span class="p">,</span> <span class="n">byref</span><span class="p">,</span> <span class="n">c_bool</span><span class="p">,</span> <span class="n">c_char_p</span><span class="p">,</span> <span class="n">c_double</span><span class="p">,</span> <span class="n">c_int</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">os</span><span class="w"> </span><span class="kn">import</span> <span class="n">environ</span><span class="p">,</span> <span class="n">path</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">fedempy.enums</span><span class="w"> </span><span class="kn">import</span> <span class="n">FmDof</span><span class="p">,</span> <span class="n">FmDofStat</span><span class="p">,</span> <span class="n">FmType</span><span class="p">,</span> <span class="n">FmVar</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fedempy.fmm</span><span class="w"> </span><span class="kn">import</span> <span class="n">FedemModel</span><span class="p">,</span> <span class="n">_convert_char</span><span class="p">,</span> <span class="n">_convert_int</span><span class="p">,</span> <span class="n">_convert_real</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_convert_bool</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a boolean from Python to C type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">arg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">c_bool</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">c_bool</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">c_bool</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">arg</span>

    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected </span><span class="si">{</span><span class="nb">bool</span><span class="si">}</span><span class="s2"> or </span><span class="si">{</span><span class="n">c_bool</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_convert_int_array</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts an array of integers from Python to C type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">arg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">c_int</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="n">argc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">argc</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">argv</span> <span class="o">=</span> <span class="p">(</span><span class="n">c_int</span> <span class="o">*</span> <span class="n">argc</span><span class="p">)()</span>
            <span class="n">argv</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">arg</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">argv</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">c_int</span><span class="p">(</span><span class="n">argc</span><span class="p">),</span> <span class="n">argv</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="s2">&quot;_length_&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="s2">&quot;_type_&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="n">c_int</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">c_int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">arg</span><span class="p">)),</span> <span class="n">arg</span>

    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected </span><span class="si">{</span><span class="nb">list</span><span class="si">}</span><span class="s2"> or </span><span class="si">{</span><span class="n">c_int</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_convert_float_array</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts an array of floats from Python to C type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">arg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">c_int</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="n">argc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">argc</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">argv</span> <span class="o">=</span> <span class="p">(</span><span class="n">c_double</span> <span class="o">*</span> <span class="n">argc</span><span class="p">)()</span>
            <span class="n">argv</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">arg</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">argv</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">c_int</span><span class="p">(</span><span class="n">argc</span><span class="p">),</span> <span class="n">argv</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="s2">&quot;_length_&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="s2">&quot;_type_&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="n">c_double</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">c_int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">arg</span><span class="p">)),</span> <span class="n">arg</span>

    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected </span><span class="si">{</span><span class="nb">list</span><span class="si">}</span><span class="s2"> or </span><span class="si">{</span><span class="n">c_double</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_extract_dofs</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts 6 DOF values into a c_double array from a dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">has_dofs</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">dof_tags</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Tx&quot;</span><span class="p">,</span> <span class="s2">&quot;Ty&quot;</span><span class="p">,</span> <span class="s2">&quot;Tz&quot;</span><span class="p">,</span> <span class="s2">&quot;Rx&quot;</span><span class="p">,</span> <span class="s2">&quot;Ry&quot;</span><span class="p">,</span> <span class="s2">&quot;Rz&quot;</span><span class="p">]</span>
    <span class="n">dof_vals</span> <span class="o">=</span> <span class="p">(</span><span class="n">c_double</span> <span class="o">*</span> <span class="mi">6</span><span class="p">)(</span><span class="o">*</span><span class="p">([</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">arg</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dof_tags</span><span class="p">:</span>
            <span class="n">dof_vals</span><span class="p">[</span><span class="n">dof_tags</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span> <span class="o">=</span> <span class="n">_convert_real</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="n">has_dofs</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="n">has_dofs</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dof_vals</span>

    <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># Return nothing if no DOF tags were found</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_extract_polyline</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts data for a polyline function from a dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">coord</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="s2">&quot;xy&quot;</span><span class="p">]</span>
    <span class="n">n_</span> <span class="o">=</span> <span class="n">c_int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coord</span><span class="p">))</span>
    <span class="n">x_</span> <span class="o">=</span> <span class="p">(</span><span class="n">c_double</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord</span><span class="p">))()</span>
    <span class="n">y_</span> <span class="o">=</span> <span class="p">(</span><span class="n">c_double</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord</span><span class="p">))()</span>
    <span class="n">x_</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">c_double</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">coord</span><span class="p">]</span>
    <span class="n">y_</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">c_double</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">coord</span><span class="p">]</span>
    <span class="n">extrap</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;NONE&quot;</span><span class="p">,</span> <span class="s2">&quot;FLAT&quot;</span><span class="p">,</span> <span class="s2">&quot;LINEAR&quot;</span><span class="p">]</span>
    <span class="n">e_type</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;extrapol_type&quot;</span><span class="p">,</span> <span class="n">extrap</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">e_type</span> <span class="ow">in</span> <span class="n">extrap</span><span class="p">:</span>
        <span class="n">e_</span> <span class="o">=</span> <span class="n">c_int</span><span class="p">(</span><span class="n">extrap</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">e_type</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">e_</span> <span class="o">=</span> <span class="n">c_int</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">n_</span><span class="p">,</span> <span class="n">x_</span><span class="p">,</span> <span class="n">y_</span><span class="p">,</span> <span class="n">e_</span>


<div class="viewcode-block" id="FedemModeler">
<a class="viewcode-back" href="../modeler.html#modeler.FedemModeler">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">FedemModeler</span><span class="p">(</span><span class="n">FedemModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This subclass of :class:`fmm.FedemModel` adds some basic modeling methods.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    model_file : str, default=None</span>
<span class="sd">        Absolute path to the fedem model file to open</span>
<span class="sd">    force_new : bool, default=False</span>
<span class="sd">        If True, any existing model will be overwritten on save</span>
<span class="sd">    plugins : str or list of str, default=None</span>
<span class="sd">        Plugin libraries with user-defined elements and functions</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    open:</span>
<span class="sd">        Opens the specified model file</span>
<span class="sd">    save:</span>
<span class="sd">        Saves current model into the specified model file</span>
<span class="sd">    close:</span>
<span class="sd">        Closes the currently open model</span>
<span class="sd">    make_triad:</span>
<span class="sd">        Creates a triad at specified location or node</span>
<span class="sd">    make_beam:</span>
<span class="sd">        Creates a string of beam elements</span>
<span class="sd">    make_beam_section:</span>
<span class="sd">        Creates a beam cross section property object</span>
<span class="sd">    make_beam_material:</span>
<span class="sd">        Creates a material property object</span>
<span class="sd">    make_spring:</span>
<span class="sd">        Creates a spring element</span>
<span class="sd">    make_damper:</span>
<span class="sd">        Creates a damper element</span>
<span class="sd">    make_joint:</span>
<span class="sd">        Creates a joint object</span>
<span class="sd">    make_load:</span>
<span class="sd">        Creates an external load object</span>
<span class="sd">    make_function:</span>
<span class="sd">        Creates a general function object</span>
<span class="sd">    make_sensor:</span>
<span class="sd">        Creates a sensor object</span>
<span class="sd">    make_fe_part:</span>
<span class="sd">        Creates an FE part</span>
<span class="sd">    make_generic_part:</span>
<span class="sd">        Creates a generic part</span>
<span class="sd">    make_strain_rosette:</span>
<span class="sd">        Creates a strain rosette on an FE part</span>
<span class="sd">    make_udelm:</span>
<span class="sd">        Creates a string of user-defined elements</span>
<span class="sd">    edit_triad:</span>
<span class="sd">        Modifies an existing triad</span>
<span class="sd">    edit_part:</span>
<span class="sd">        Modifies an existing FE part</span>
<span class="sd">    edit_joint:</span>
<span class="sd">        Modifies an existing joint</span>
<span class="sd">    edit_function:</span>
<span class="sd">        Modifies an existing function</span>
<span class="sd">    solver_setup:</span>
<span class="sd">        Setting dynamics solver parameters</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">force_new</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plugins</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor.</span>
<span class="sd">        Optionally opens a Fedem model, if a model file name is specified.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fedem_lib</span> <span class="o">=</span> <span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;FEDEM_MDB&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">fedem_lib</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> *** Environment variable FEDEM_MDB is not set!&quot;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">return</span>  <span class="c1"># This will probably cause crash later, but not here</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plugins</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">fedem_lib</span><span class="p">,</span> <span class="n">plugins</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plugins</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">plugins</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">plugins</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">fedem_lib</span><span class="p">,</span> <span class="n">plugins</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">plugins</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">fedem_lib</span><span class="p">,</span> <span class="n">plugins</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">fedem_lib</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateTriad</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateTriad</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">c_char_p</span><span class="p">,</span>
            <span class="n">c_double</span><span class="p">,</span>
            <span class="n">c_double</span><span class="p">,</span>
            <span class="n">c_double</span><span class="p">,</span>
            <span class="n">c_double</span><span class="p">,</span>
            <span class="n">c_double</span><span class="p">,</span>
            <span class="n">c_double</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmTriadOnNode</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmTriadOnNode</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">c_char_p</span><span class="p">,</span> <span class="n">c_int</span><span class="p">,</span> <span class="n">c_int</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateBeam</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateBeam</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">c_char_p</span><span class="p">,</span> <span class="n">c_int</span><span class="p">,</span> <span class="n">c_int</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateBeamProperty</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateBeamProperty</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">c_char_p</span><span class="p">,</span>
            <span class="n">c_int</span><span class="p">,</span>
            <span class="n">c_int</span><span class="p">,</span>
            <span class="n">POINTER</span><span class="p">(</span><span class="n">c_double</span><span class="p">),</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateMaterialProperty</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateMaterialProperty</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">c_char_p</span><span class="p">,</span>
            <span class="n">c_int</span><span class="p">,</span>
            <span class="n">POINTER</span><span class="p">(</span><span class="n">c_double</span><span class="p">),</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateSpring</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateSpring</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">c_char_p</span><span class="p">,</span>
            <span class="n">c_int</span><span class="p">,</span>
            <span class="n">c_int</span><span class="p">,</span>
            <span class="n">c_double</span><span class="p">,</span>
            <span class="n">c_bool</span><span class="p">,</span>
            <span class="n">c_double</span><span class="p">,</span>
            <span class="n">POINTER</span><span class="p">(</span><span class="n">c_int</span><span class="p">),</span>
            <span class="n">c_int</span><span class="p">,</span>
            <span class="n">POINTER</span><span class="p">(</span><span class="n">c_double</span><span class="p">),</span>
            <span class="n">POINTER</span><span class="p">(</span><span class="n">c_double</span><span class="p">),</span>
            <span class="n">c_int</span><span class="p">,</span>
            <span class="n">c_int</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateDamper</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateDamper</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">c_char_p</span><span class="p">,</span>
            <span class="n">c_int</span><span class="p">,</span>
            <span class="n">c_int</span><span class="p">,</span>
            <span class="n">c_bool</span><span class="p">,</span>
            <span class="n">c_double</span><span class="p">,</span>
            <span class="n">POINTER</span><span class="p">(</span><span class="n">c_int</span><span class="p">),</span>
            <span class="n">c_int</span><span class="p">,</span>
            <span class="n">POINTER</span><span class="p">(</span><span class="n">c_double</span><span class="p">),</span>
            <span class="n">POINTER</span><span class="p">(</span><span class="n">c_double</span><span class="p">),</span>
            <span class="n">c_int</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateJoint</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateJoint</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">c_char_p</span><span class="p">,</span>
            <span class="n">c_int</span><span class="p">,</span>
            <span class="n">c_int</span><span class="p">,</span>
            <span class="n">POINTER</span><span class="p">(</span><span class="n">c_int</span><span class="p">),</span>
            <span class="n">c_int</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateLoad</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateLoad</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">c_char_p</span><span class="p">,</span>
            <span class="n">c_int</span><span class="p">,</span>
            <span class="n">c_int</span><span class="p">,</span>
            <span class="n">c_double</span><span class="p">,</span>
            <span class="n">c_double</span><span class="p">,</span>
            <span class="n">c_double</span><span class="p">,</span>
            <span class="n">c_char_p</span><span class="p">,</span>
            <span class="n">c_int</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateMathExprFunc</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateMathExprFunc</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">c_char_p</span><span class="p">,</span>
            <span class="n">c_char_p</span><span class="p">,</span>
            <span class="n">c_char_p</span><span class="p">,</span>
            <span class="n">c_bool</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateExternalFunc</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateExternalFunc</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">c_char_p</span><span class="p">,</span> <span class="n">c_char_p</span><span class="p">,</span> <span class="n">c_bool</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateSineFunc</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateSineFunc</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">c_char_p</span><span class="p">,</span>
            <span class="n">c_char_p</span><span class="p">,</span>
            <span class="n">POINTER</span><span class="p">(</span><span class="n">c_double</span><span class="p">),</span>
            <span class="n">c_bool</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateLinearFunc</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateLinearFunc</span><span class="o">.</span><span class="n">argstypes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">c_char_p</span><span class="p">,</span>
            <span class="n">c_char_p</span><span class="p">,</span>
            <span class="n">POINTER</span><span class="p">(</span><span class="n">c_double</span><span class="p">),</span>
            <span class="n">c_bool</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreatePolyFunc</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreatePolyFunc</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">c_char_p</span><span class="p">,</span>
            <span class="n">c_char_p</span><span class="p">,</span>
            <span class="n">c_int</span><span class="p">,</span>
            <span class="n">POINTER</span><span class="p">(</span><span class="n">c_double</span><span class="p">),</span>
            <span class="n">POINTER</span><span class="p">(</span><span class="n">c_double</span><span class="p">),</span>
            <span class="n">c_int</span><span class="p">,</span>
            <span class="n">c_bool</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateDeviceFunc</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateDeviceFunc</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">c_char_p</span><span class="p">,</span>
            <span class="n">c_char_p</span><span class="p">,</span>
            <span class="n">c_char_p</span><span class="p">,</span>
            <span class="n">c_char_p</span><span class="p">,</span>
            <span class="n">c_double</span><span class="p">,</span>
            <span class="n">c_bool</span><span class="p">,</span>
            <span class="n">c_double</span><span class="p">,</span>
            <span class="n">c_bool</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateSensor</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateSensor</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">c_char_p</span><span class="p">,</span>
            <span class="n">c_char_p</span><span class="p">,</span>
            <span class="n">c_int</span><span class="p">,</span>
            <span class="n">c_int</span><span class="p">,</span>
            <span class="n">c_int</span><span class="p">,</span>
            <span class="n">c_int</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmSetFunctionArg</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_bool</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmSetFunctionArg</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">c_int</span><span class="p">,</span> <span class="n">c_int</span><span class="p">,</span> <span class="n">c_int</span><span class="p">,</span> <span class="n">c_int</span><span class="p">,</span> <span class="n">c_int</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmLoadPart</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmLoadPart</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">c_char_p</span><span class="p">,</span> <span class="n">c_char_p</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreatePart</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreatePart</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">c_char_p</span><span class="p">,</span> <span class="n">c_int</span><span class="p">,</span> <span class="n">POINTER</span><span class="p">(</span><span class="n">c_int</span><span class="p">)]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateStrainRosette</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateStrainRosette</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">c_char_p</span><span class="p">,</span>
            <span class="n">c_int</span><span class="p">,</span>
            <span class="n">c_int</span><span class="p">,</span>
            <span class="n">POINTER</span><span class="p">(</span><span class="n">c_int</span><span class="p">),</span>
            <span class="n">POINTER</span><span class="p">(</span><span class="n">c_double</span><span class="p">),</span>
            <span class="n">c_double</span><span class="p">,</span>
            <span class="n">c_bool</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateUDE2</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateUDE2</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">c_char_p</span><span class="p">,</span> <span class="n">c_int</span><span class="p">,</span> <span class="n">c_int</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateAssembly</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateAssembly</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">c_char_p</span><span class="p">,</span> <span class="n">c_int</span><span class="p">,</span> <span class="n">POINTER</span><span class="p">(</span><span class="n">c_int</span><span class="p">)]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmMoveObject</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_bool</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmMoveObject</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">c_int</span><span class="p">,</span> <span class="n">POINTER</span><span class="p">(</span><span class="n">c_double</span><span class="p">),</span> <span class="n">c_int</span><span class="p">,</span> <span class="n">c_int</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmConstrainObject</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_bool</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmConstrainObject</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">c_int</span><span class="p">,</span> <span class="n">c_int</span><span class="p">,</span> <span class="n">c_int</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmAddMass</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_bool</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmAddMass</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">c_int</span><span class="p">,</span> <span class="n">c_int</span><span class="p">,</span> <span class="n">POINTER</span><span class="p">(</span><span class="n">c_double</span><span class="p">),</span> <span class="n">c_int</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmDofProperty</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_bool</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmDofProperty</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">c_int</span><span class="p">,</span> <span class="n">c_int</span><span class="p">,</span> <span class="n">c_int</span><span class="p">,</span> <span class="n">c_double</span><span class="p">,</span> <span class="n">c_int</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmStructDamp</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_bool</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmStructDamp</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">c_int</span><span class="p">,</span> <span class="n">c_double</span><span class="p">,</span> <span class="n">c_double</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmReduceOpts</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_bool</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmReduceOpts</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">c_int</span><span class="p">,</span> <span class="n">c_int</span><span class="p">,</span> <span class="n">c_bool</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmRecoverOpts</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">c_bool</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmRecoverOpts</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">c_int</span><span class="p">,</span> <span class="n">c_int</span><span class="p">,</span> <span class="n">c_bool</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">model_file</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">model_file</span><span class="p">)</span> <span class="ow">or</span> <span class="n">force_new</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fm_new</span><span class="p">(</span><span class="n">model_file</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">fm_open</span><span class="p">(</span><span class="n">model_file</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; *** Failed to open model file&quot;</span><span class="p">,</span> <span class="n">model_file</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_convert_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_ids</span><span class="p">,</span> <span class="n">obj_type</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convenience method, to reduce cognitive complexity.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj_ids</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">obj_ids</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_id</span><span class="p">(</span><span class="n">obj_ids</span><span class="p">,</span> <span class="n">obj_type</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

<div class="viewcode-block" id="FedemModeler.open">
<a class="viewcode-back" href="../modeler.html#modeler.FedemModeler.open">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_file</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Opens the specified model file and prints out some key model parameters.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        model_file : str</span>
<span class="sd">            Absolute path of the Fedem model file to open</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True on success, otherwise False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">fm_open</span><span class="p">(</span><span class="n">model_file</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; *** Failed to open model file&quot;</span><span class="p">,</span> <span class="n">model_file</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   * Model file&quot;</span><span class="p">,</span> <span class="n">model_file</span><span class="p">,</span> <span class="s2">&quot;successfully opened&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;     Number of Triads:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fm_count</span><span class="p">(</span><span class="n">FmType</span><span class="o">.</span><span class="n">TRIAD</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;     Number of Beams:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fm_count</span><span class="p">(</span><span class="n">FmType</span><span class="o">.</span><span class="n">BEAM</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;     Number of Parts:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fm_count</span><span class="p">(</span><span class="n">FmType</span><span class="o">.</span><span class="n">FEPART</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;     Total number of mechanism objects:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fm_count</span><span class="p">())</span>

        <span class="k">return</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="FedemModeler.save">
<a class="viewcode-back" href="../modeler.html#modeler.FedemModeler.save">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_file</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves current model into the specified model file.</span>

<span class="sd">        If no model_file is given, that last opened model file is overwritten.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        model_file : str, default=None</span>
<span class="sd">            Absolute path of the Fedem model file to save to</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True on success, otherwise False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fm_save</span><span class="p">(</span><span class="n">model_file</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">status</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; *** Failed to save model file&quot;</span><span class="p">,</span> <span class="n">model_file</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">status</span></div>


<div class="viewcode-block" id="FedemModeler.close">
<a class="viewcode-back" href="../modeler.html#modeler.FedemModeler.close">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_singletons</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Closes the currently open model.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        save : bool, default=False</span>
<span class="sd">            If True, the model file is updated with the current model</span>
<span class="sd">        remove_singletons : bool, default=False</span>
<span class="sd">            If True, heap-allocated singelton objects are also released</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True on success, otherwise False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fm_save</span><span class="p">()</span> <span class="k">if</span> <span class="n">save</span> <span class="k">else</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">status</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; *** Failed to save current fedem model&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fm_close</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fm_close</span><span class="p">(</span><span class="n">remove_singletons</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">status</span></div>


<div class="viewcode-block" id="FedemModeler.make_triad">
<a class="viewcode-back" href="../modeler.html#modeler.FedemModeler.make_triad">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">make_triad</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">node</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">on_part</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a new triad at specified location or nodal point.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Description of the new triad</span>
<span class="sd">        pos : (float, float, float)</span>
<span class="sd">            Global XYZ-coordinates of new triad</span>
<span class="sd">        rot : (float, float, float), default=None</span>
<span class="sd">            Global Euler angles giving the orientation of new triad</span>
<span class="sd">        node : int, default=0</span>
<span class="sd">            FE node number to associate the triad with.</span>
<span class="sd">            Used only if `on_part` is specified.</span>
<span class="sd">        on_part : int or str, default=0</span>
<span class="sd">            Base Id or tag of the part that this triad should be attached to.</span>
<span class="sd">            You can also specify the Reference plane here,</span>
<span class="sd">            to create a new triad that is attached to ground.</span>
<span class="sd">        tag : str, default=None</span>
<span class="sd">            Tag to associate the created triad with</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            Base Id of new triad, zero or negative on error</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">part_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_id</span><span class="p">(</span><span class="n">on_part</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">node</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">part_</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">triad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmTriadOnNode</span><span class="p">(</span>
                <span class="n">_convert_char</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">_convert_int</span><span class="p">(</span><span class="n">node</span><span class="p">),</span> <span class="n">part_</span>
            <span class="p">)</span>

        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; *** Invalid Triad position&quot;</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
            <span class="n">triad</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="k">elif</span> <span class="n">rot</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
                <span class="n">triad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateTriad</span><span class="p">(</span>
                    <span class="n">_convert_char</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
                    <span class="n">_convert_real</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                    <span class="n">_convert_real</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                    <span class="n">_convert_real</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                    <span class="n">_convert_real</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
                    <span class="n">_convert_real</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span>
                    <span class="n">_convert_real</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">5</span><span class="p">]),</span>
                    <span class="n">part_</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">triad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateTriad</span><span class="p">(</span>
                    <span class="n">_convert_char</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
                    <span class="n">_convert_real</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                    <span class="n">_convert_real</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                    <span class="n">_convert_real</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                    <span class="n">c_double</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
                    <span class="n">c_double</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
                    <span class="n">c_double</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
                    <span class="n">part_</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">rot</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; *** Invalid Triad rotation&quot;</span><span class="p">,</span> <span class="n">rot</span><span class="p">)</span>
            <span class="n">triad</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">triad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateTriad</span><span class="p">(</span>
                <span class="n">_convert_char</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
                <span class="n">_convert_real</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                <span class="n">_convert_real</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                <span class="n">_convert_real</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                <span class="n">_convert_real</span><span class="p">(</span><span class="n">rot</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                <span class="n">_convert_real</span><span class="p">(</span><span class="n">rot</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                <span class="n">_convert_real</span><span class="p">(</span><span class="n">rot</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                <span class="n">part_</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">tag</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">triad</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fm_tag_object</span><span class="p">(</span><span class="n">triad</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">triad</span></div>


<div class="viewcode-block" id="FedemModeler.make_beam">
<a class="viewcode-back" href="../modeler.html#modeler.FedemModeler.make_beam">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">make_beam</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">triads</span><span class="p">,</span> <span class="n">bprop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a string of beam elements.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Description of the new beam(s)</span>
<span class="sd">        triads : list of int or list of str</span>
<span class="sd">            List of base Ids or tags of the connected triads</span>
<span class="sd">        bprop : int or str, default=None</span>
<span class="sd">            Base Id or tag of beam property to use</span>
<span class="sd">        tag : str, default=None</span>
<span class="sd">            Tag to associate the created beam(s) with</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list of int</span>
<span class="sd">            Base Ids of the created beams, None if error</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">triads</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; *** make_beam: At least two triads must be specified&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">base_ids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">triads</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">base_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateBeam</span><span class="p">(</span>
                <span class="n">_convert_char</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_convert_id</span><span class="p">(</span><span class="n">triads</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">FmType</span><span class="o">.</span><span class="n">TRIAD</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_convert_id</span><span class="p">(</span><span class="n">triads</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">FmType</span><span class="o">.</span><span class="n">TRIAD</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_convert_id</span><span class="p">(</span><span class="n">bprop</span><span class="p">,</span> <span class="n">FmType</span><span class="o">.</span><span class="n">BEAM_PROP</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">base_id</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="n">base_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">base_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">tag</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fm_tag_object</span><span class="p">(</span><span class="n">base_ids</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">base_ids</span></div>


<div class="viewcode-block" id="FedemModeler.make_beam_section">
<a class="viewcode-back" href="../modeler.html#modeler.FedemModeler.make_beam_section">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">make_beam_section</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">mat</span><span class="p">,</span> <span class="n">bprops</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a beam cross section property object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Description of the new beam property</span>
<span class="sd">        mat : int or str</span>
<span class="sd">            Cross section type flag.</span>
<span class="sd">            If zero, a Generic cross section is defined.</span>
<span class="sd">            If str or a non-zero int, a Pipe cross section is defined,</span>
<span class="sd">            and the value gives the tag or base Id of the material to use.</span>
<span class="sd">        bprop : list of float</span>
<span class="sd">            List of property data</span>
<span class="sd">        tag : str, default=None</span>
<span class="sd">            Tag to associate the created beam property with</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            Base Id of beam property object, zero or negative on error</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nprop_</span><span class="p">,</span> <span class="n">prop_</span> <span class="o">=</span> <span class="n">_convert_float_array</span><span class="p">(</span><span class="n">bprops</span><span class="p">)</span>
        <span class="n">bprop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateBeamProperty</span><span class="p">(</span>
            <span class="n">_convert_char</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_convert_id</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">FmType</span><span class="o">.</span><span class="n">MAT_PROP</span><span class="p">),</span>
            <span class="n">nprop_</span><span class="p">,</span>
            <span class="n">prop_</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">tag</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">bprop</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fm_tag_object</span><span class="p">(</span><span class="n">bprop</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">bprop</span></div>


<div class="viewcode-block" id="FedemModeler.make_beam_material">
<a class="viewcode-back" href="../modeler.html#modeler.FedemModeler.make_beam_material">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">make_beam_material</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">mprops</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a material property object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Description of the new material property</span>
<span class="sd">        mprop : list of float</span>
<span class="sd">            List of property data</span>
<span class="sd">        tag : str, default=None</span>
<span class="sd">            Tag to associate the created material property with</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            Base Id of material property object, zero or negative on error</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nprop_</span><span class="p">,</span> <span class="n">prop_</span> <span class="o">=</span> <span class="n">_convert_float_array</span><span class="p">(</span><span class="n">mprops</span><span class="p">)</span>
        <span class="n">mprop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateMaterialProperty</span><span class="p">(</span><span class="n">_convert_char</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">nprop_</span><span class="p">,</span> <span class="n">prop_</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">tag</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">mprop</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fm_tag_object</span><span class="p">(</span><span class="n">mprop</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">mprop</span></div>


<div class="viewcode-block" id="FedemModeler.make_spring">
<a class="viewcode-back" href="../modeler.html#modeler.FedemModeler.make_spring">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">make_spring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">triads</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates axial spring elements.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Description of the new spring(s)</span>
<span class="sd">        triads : (str, str) or (int, int) or list of (int, int)</span>
<span class="sd">            Tags or base Ids of the connected triads.</span>
<span class="sd">            If a list of tuples is specified,</span>
<span class="sd">            one spring is created for each tuple.</span>
<span class="sd">        tag : str, default=None</span>
<span class="sd">            Tag to associate the created beam(s) with</span>
<span class="sd">        kwargs : dict</span>
<span class="sd">            Keyword arguments defining the spring properties.</span>
<span class="sd">            The following keywords are currently supported:</span>

<span class="sd">            * `tag` : Tag to associate the created spring(s) with</span>
<span class="sd">            * `constDefl`: Constant stress free deflection</span>
<span class="sd">            * `constLength`: Constant stress free length</span>
<span class="sd">            * `length`: User Id of general function defining stress free length</span>
<span class="sd">            * `init_Stiff_Coeff`: Constant spring stiffness coefficient</span>
<span class="sd">            * `fn`: Base Id of spring stiffness function</span>
<span class="sd">            * `xy`: List of XY-pairs giving a piece-wise linear spring stiffness</span>
<span class="sd">            * `extrapol_type`: String, either &quot;NONE&quot; (default), &quot;FLAT&quot; or &quot;LINEAR&quot;</span>
<span class="sd">            * `spring_characteristics`: String, either &quot;SPR_TRA_STIFF&quot; (default)</span>
<span class="sd">              or &quot;SPR_TRA_FORCE&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int or list of int</span>
<span class="sd">            Base Id(s) of the created spring(s), None if an error occurs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n_</span> <span class="o">=</span> <span class="n">c_int</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">x_</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">y_</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">e_</span> <span class="o">=</span> <span class="n">c_int</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">use_constant_defl_</span> <span class="o">=</span> <span class="n">c_bool</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># default is constant deflection</span>
        <span class="k">if</span> <span class="s2">&quot;constDefl&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">const_length_defl_</span> <span class="o">=</span> <span class="n">_convert_real</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;constDefl&quot;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="s2">&quot;constLength&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">const_length_defl_</span> <span class="o">=</span> <span class="n">_convert_real</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;constLength&quot;</span><span class="p">])</span>
            <span class="n">use_constant_defl_</span> <span class="o">=</span> <span class="n">c_bool</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">const_length_defl_</span> <span class="o">=</span> <span class="n">c_double</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;fn&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>  <span class="c1"># Base Id of existing spring function</span>
            <span class="n">sp_</span> <span class="o">=</span> <span class="n">_convert_int</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;fn&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sp_</span> <span class="o">=</span> <span class="n">c_int</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;xy&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="c1"># We have data of a new spring stiffness function</span>
            <span class="n">n_</span><span class="p">,</span> <span class="n">x_</span><span class="p">,</span> <span class="n">y_</span><span class="p">,</span> <span class="n">e_</span> <span class="o">=</span> <span class="n">_extract_polyline</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="n">charac</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;SPR_TRA_STIFF&quot;</span><span class="p">,</span>  <span class="c1"># stiffness - translational deflection</span>
                <span class="s2">&quot;SPR_TRA_FORCE&quot;</span><span class="p">,</span>  <span class="c1"># force - translational deflection</span>
            <span class="p">]</span>
            <span class="n">sp_charac</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;spring_characteristics&quot;</span><span class="p">,</span> <span class="n">charac</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">sp_charac</span> <span class="ow">in</span> <span class="n">charac</span><span class="p">:</span>
                <span class="c1"># Notice negative value to indicate spring function type</span>
                <span class="n">sp_</span> <span class="o">=</span> <span class="n">c_int</span><span class="p">(</span><span class="o">-</span><span class="n">charac</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">sp_charac</span><span class="p">))</span>

        <span class="n">one_spring</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">triads</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">one_spring</span><span class="p">:</span>
            <span class="n">triads</span> <span class="o">=</span> <span class="p">[</span><span class="n">triads</span><span class="p">]</span>  <span class="c1"># Only one spring is created</span>

        <span class="n">base_ids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">triad</span> <span class="ow">in</span> <span class="n">triads</span><span class="p">:</span>
            <span class="n">s_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateSpring</span><span class="p">(</span>
                <span class="n">_convert_char</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_convert_id</span><span class="p">(</span><span class="n">triad</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">FmType</span><span class="o">.</span><span class="n">TRIAD</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_convert_id</span><span class="p">(</span><span class="n">triad</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">FmType</span><span class="o">.</span><span class="n">TRIAD</span><span class="p">),</span>
                <span class="n">const_length_defl_</span><span class="p">,</span>
                <span class="n">use_constant_defl_</span><span class="p">,</span>
                <span class="n">_convert_real</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;init_Stiff_Coeff&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)),</span>
                <span class="n">byref</span><span class="p">(</span><span class="n">sp_</span><span class="p">),</span>
                <span class="n">n_</span><span class="p">,</span>
                <span class="n">x_</span><span class="p">,</span>
                <span class="n">y_</span><span class="p">,</span>
                <span class="n">e_</span><span class="p">,</span>
                <span class="n">_convert_int</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;length&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">s_id</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">base_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">base_ids</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">triads</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># Failure creating at least one spring</span>

        <span class="k">if</span> <span class="s2">&quot;tag&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fm_tag_object</span><span class="p">(</span><span class="n">base_ids</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;tag&quot;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">one_spring</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">base_ids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">base_ids</span></div>


<div class="viewcode-block" id="FedemModeler.make_damper">
<a class="viewcode-back" href="../modeler.html#modeler.FedemModeler.make_damper">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">make_damper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">triads</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates axial damper elements.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Description of the new damper(s)</span>
<span class="sd">        triads : (str, str) or (int, int) or list of (int, int)</span>
<span class="sd">            Tags or base Ids of the connected triads.</span>
<span class="sd">            If a list of tuples is specified,</span>
<span class="sd">            one damper is created for each tuple.</span>
<span class="sd">        kwargs : dict</span>
<span class="sd">            Keyword arguments defining the damper properties.</span>
<span class="sd">            The following keywords are currently supported:</span>

<span class="sd">            * `tag` : Tag to associate the created damper(s) with</span>
<span class="sd">            * `def_vel_damper`: If True, use deformational velocity</span>
<span class="sd">            * `init_Damp_Coeff`: Constant damping coefficient</span>
<span class="sd">            * `fn`: Base Id of damping coefficient function</span>
<span class="sd">            * `xy`: List of XY-pairs giving a piece-wise linear damping coefficient</span>
<span class="sd">            * `extrapol_type`: String, either &quot;NONE&quot; (default), &quot;FLAT&quot; or &quot;LINEAR&quot;</span>
<span class="sd">            * `damp_characteristics`: String, either &quot;DA_TRA_COEFF&quot; (default)</span>
<span class="sd">              or &quot;DA_TRA_FORCE&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int or list of int</span>
<span class="sd">            Base Id(s) of the created damper(s), None if an error occurs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n_</span> <span class="o">=</span> <span class="n">c_int</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">x_</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">y_</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">e_</span> <span class="o">=</span> <span class="n">c_int</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;fn&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>  <span class="c1"># Base Id of existing damper function</span>
            <span class="n">da_</span> <span class="o">=</span> <span class="n">_convert_int</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;fn&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">da_</span> <span class="o">=</span> <span class="n">c_int</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;xy&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="c1"># We have data of a new damping coefficient function</span>
            <span class="n">n_</span><span class="p">,</span> <span class="n">x_</span><span class="p">,</span> <span class="n">y_</span><span class="p">,</span> <span class="n">e_</span> <span class="o">=</span> <span class="n">_extract_polyline</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="n">charac</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;DA_TRA_COEFF&quot;</span><span class="p">,</span>  <span class="c1"># damping coefficient - translational velocity</span>
                <span class="s2">&quot;DA_TRA_FORCE&quot;</span><span class="p">,</span>  <span class="c1"># force - translational velocity</span>
            <span class="p">]</span>
            <span class="n">da_charac</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;damp_characteristics&quot;</span><span class="p">,</span> <span class="n">charac</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">da_charac</span> <span class="ow">in</span> <span class="n">charac</span><span class="p">:</span>
                <span class="c1"># Notice negative value to indicate damper function type</span>
                <span class="n">da_</span> <span class="o">=</span> <span class="n">c_int</span><span class="p">(</span><span class="o">-</span><span class="n">charac</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">da_charac</span><span class="p">))</span>

        <span class="n">one_damper</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">triads</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">one_damper</span><span class="p">:</span>
            <span class="n">triads</span> <span class="o">=</span> <span class="p">[</span><span class="n">triads</span><span class="p">]</span>  <span class="c1"># Only one damper is created</span>

        <span class="n">base_ids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">triad</span> <span class="ow">in</span> <span class="n">triads</span><span class="p">:</span>
            <span class="n">d_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateDamper</span><span class="p">(</span>
                <span class="n">_convert_char</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_convert_id</span><span class="p">(</span><span class="n">triad</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">FmType</span><span class="o">.</span><span class="n">TRIAD</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_convert_id</span><span class="p">(</span><span class="n">triad</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">FmType</span><span class="o">.</span><span class="n">TRIAD</span><span class="p">),</span>
                <span class="n">_convert_bool</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;def_vel_damper&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)),</span>
                <span class="n">_convert_real</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;init_Damp_Coeff&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)),</span>
                <span class="n">byref</span><span class="p">(</span><span class="n">da_</span><span class="p">),</span>
                <span class="n">n_</span><span class="p">,</span>
                <span class="n">x_</span><span class="p">,</span>
                <span class="n">y_</span><span class="p">,</span>
                <span class="n">e_</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">d_id</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">base_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">base_ids</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">triads</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># Failure creating at least one damper</span>

        <span class="k">if</span> <span class="s2">&quot;tag&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fm_tag_object</span><span class="p">(</span><span class="n">base_ids</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;tag&quot;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">one_damper</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">base_ids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">base_ids</span></div>


<div class="viewcode-block" id="FedemModeler.make_joint">
<a class="viewcode-back" href="../modeler.html#modeler.FedemModeler.make_joint">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">make_joint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">joint_type</span><span class="p">,</span> <span class="n">follower</span><span class="p">,</span> <span class="n">followed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a joint object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Description of the new joint</span>
<span class="sd">        joint_type : FmType</span>
<span class="sd">            Type of joint</span>
<span class="sd">        follower : int or str</span>
<span class="sd">            Base Id or tag of the dependent joint triad</span>
<span class="sd">        followed : int or str or list of int, default=None</span>
<span class="sd">            Base Id or tag of the independent joint triad(s).</span>
<span class="sd">            If None, the joint is connected to ground and the independent</span>
<span class="sd">            triad is created at the same location as the dependent triad.</span>
<span class="sd">            For point-to-path joints, the first two triads specified</span>
<span class="sd">            are taken as the end points of the glider.</span>
<span class="sd">        tag : str, default=None</span>
<span class="sd">            Tag to associate the created joint with</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            Base Id of joint object, zero or negative on error</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">id_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_id</span><span class="p">(</span><span class="n">follower</span><span class="p">,</span> <span class="n">FmType</span><span class="o">.</span><span class="n">TRIAD</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">followed</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">nids_</span><span class="p">,</span> <span class="n">ids_</span> <span class="o">=</span> <span class="n">_convert_int_array</span><span class="p">(</span><span class="n">followed</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nids_</span> <span class="o">=</span> <span class="n">c_int</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ids_</span> <span class="o">=</span> <span class="p">(</span><span class="n">c_int</span> <span class="o">*</span> <span class="mi">1</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">_convert_id</span><span class="p">(</span><span class="n">followed</span><span class="p">,</span> <span class="n">FmType</span><span class="o">.</span><span class="n">TRIAD</span><span class="p">))</span>

        <span class="n">joint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateJoint</span><span class="p">(</span>
            <span class="n">_convert_char</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">_convert_int</span><span class="p">(</span><span class="n">joint_type</span><span class="p">),</span> <span class="n">id_</span><span class="p">,</span> <span class="n">ids_</span><span class="p">,</span> <span class="n">nids_</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">tag</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">joint</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fm_tag_object</span><span class="p">(</span><span class="n">joint</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">joint</span></div>


<div class="viewcode-block" id="FedemModeler.make_load">
<a class="viewcode-back" href="../modeler.html#modeler.FedemModeler.make_load">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">make_load</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">load_type</span><span class="p">,</span> <span class="n">triad</span><span class="p">,</span> <span class="n">load_dir</span><span class="p">,</span> <span class="n">magnitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fn</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates an external load object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Description of the new load</span>
<span class="sd">        load_type : FmLoadType</span>
<span class="sd">            Type of load</span>
<span class="sd">        triad : int or str</span>
<span class="sd">            Base Id or tag of triad where the load attacks</span>
<span class="sd">        load_dir : (float, float, float)</span>
<span class="sd">            Load direction vector</span>
<span class="sd">        magnitude : str, default=None</span>
<span class="sd">            Load magnitude expression</span>
<span class="sd">        fn : int, default=0</span>
<span class="sd">            User Id of load magnitude function</span>
<span class="sd">        tag : str, default=None</span>
<span class="sd">            Tag to associate the created load with</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            Base Id of load object, zero or negative on error</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">load_dir</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; *** Invalid load direction vector&quot;</span><span class="p">,</span> <span class="n">load_dir</span><span class="p">)</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

        <span class="n">load</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateLoad</span><span class="p">(</span>
            <span class="n">_convert_char</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
            <span class="n">_convert_int</span><span class="p">(</span><span class="n">load_type</span><span class="p">),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_convert_id</span><span class="p">(</span><span class="n">triad</span><span class="p">,</span> <span class="n">FmType</span><span class="o">.</span><span class="n">TRIAD</span><span class="p">),</span>
            <span class="n">_convert_real</span><span class="p">(</span><span class="n">load_dir</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
            <span class="n">_convert_real</span><span class="p">(</span><span class="n">load_dir</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
            <span class="n">_convert_real</span><span class="p">(</span><span class="n">load_dir</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
            <span class="n">_convert_char</span><span class="p">(</span><span class="n">magnitude</span><span class="p">),</span>
            <span class="n">_convert_int</span><span class="p">(</span><span class="n">fn</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">tag</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">load</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fm_tag_object</span><span class="p">(</span><span class="n">load</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">load</span></div>


<div class="viewcode-block" id="FedemModeler.make_function">
<a class="viewcode-back" href="../modeler.html#modeler.FedemModeler.make_function">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">make_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a general function of time.</span>

<span class="sd">        The type of function to be created is determined</span>
<span class="sd">        by which keyword arguments are provided.</span>
<span class="sd">        The keyword determining the function type is below marked</span>
<span class="sd">        by an asterix (:sup:`*`) in each case.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Description of the new function</span>

<span class="sd">        kwargs : dict</span>
<span class="sd">            Keyword arguments depending on function type.</span>
<span class="sd">            The following **function types** and `keywords`</span>
<span class="sd">            are currently supported:</span>

<span class="sd">            1. **Polyline**</span>

<span class="sd">              | `xy`:sup:`*`: List of `XY`-pairs giving a</span>
<span class="sd">                              piece-wise linear curve</span>
<span class="sd">              | `extrapol_type`: String, either &quot;NONE&quot; (default),</span>
<span class="sd">                                 &quot;FLAT&quot; or &quot;LINEAR&quot;</span>

<span class="sd">            2. **Polyline-from-file**</span>

<span class="sd">              | `filename`:sup:`*`: Name of file containing `XY`-pairs</span>
<span class="sd">              | `ch_name`: String identifying the column to use</span>
<span class="sd">                           for multi-column files</span>
<span class="sd">              | `sc_factor`: Scaling factor, default=1.0</span>
<span class="sd">              | `z_adjust`: If True, the `y`-values are shifted</span>
<span class="sd">                            such that the first value is zero, default=False</span>
<span class="sd">              | `v_shift`: Additional shift of the `y`-values, default=0.0</span>

<span class="sd">            3. **Sine**</span>

<span class="sd">              | `frequency`:sup:`*`: Angular frequency</span>
<span class="sd">              | `amplitude`: Scaling factor, default=1.0</span>
<span class="sd">              | `delay`: Phase shift, default=0.0</span>
<span class="sd">              | `mean_value`: Constant shift, default=0.0</span>
<span class="sd">              | `end`: Default=0.0, if greater than zero, the function</span>
<span class="sd">                       value is constant for `x` greater than `end`</span>

<span class="sd">              The Sine function therefore evaluates to::</span>

<span class="sd">                  f(x) = amplitude*sin(frequency*x-delay) + mean_value</span>

<span class="sd">              for `x`-values less than `end`, whereas ``f(x) = f(end)``</span>
<span class="sd">              for `x` greater than `end`.</span>

<span class="sd">            4. **Constant**</span>

<span class="sd">              | `value`:sup:`*`: The constant function value, i.e.,</span>
<span class="sd">                                 ``f(x) = value`` for any `x`</span>

<span class="sd">            5. **Linear**</span>

<span class="sd">              | `slope`:sup:`*`: The scaling factor, i.e., ``f(x) = slope*x``</span>

<span class="sd">            6. **Ramp**</span>

<span class="sd">              | `start_ramp`:sup:`*`: Start point of sloped function domain</span>
<span class="sd">              | `start_val`: Function value before `start_ramp`, default=0.0</span>
<span class="sd">              | `slope`: The scaling factor, default=1.0</span>

<span class="sd">              The Ramp function therefore evaluates to::</span>

<span class="sd">                  f(x) = start_val + slope*(x-start_ramp)</span>

<span class="sd">              | for `x`-values greater than `start_ramp`, whereas</span>
<span class="sd">              | ``f(x) = start_val`` for `x` less than or equal to `start_ramp`.</span>

<span class="sd">            7. **Limited Ramp**</span>

<span class="sd">              | `start_ramp`: Start point of sloped function domain, default=0.0</span>
<span class="sd">              | `end_ramp`:sup:`*`: End point of sloped function domain</span>
<span class="sd">              | `start_val`: Function value before `start_ramp`, default=0.0</span>
<span class="sd">              | `slope`: The scaling factor, default=1.0</span>

<span class="sd">              The Limited Ramp function therefore evaluates to::</span>

<span class="sd">                  f(x) = start_val + slope*(x-start_ramp)</span>

<span class="sd">              | for `x`-values in the range [`start_ramp`, `end_ramp`]</span>
<span class="sd">              | whereas ``f(x) = start_val`` for `x` less than `start_ramp`,</span>
<span class="sd">              | and ``f(x) = f(end_ramp)`` for `x` greater than `end_ramp`.</span>

<span class="sd">            8. **Math expression**</span>

<span class="sd">              | `expression`:sup:`*`: String containing the expression to use</span>

<span class="sd">            9. **External function**</span>

<span class="sd">              | No keywords</span>

<span class="sd">           In addition, the `tag` keyword is accepted for all function types,</span>
<span class="sd">           to associate a specified tag with the created function, and the</span>
<span class="sd">           `base_id` keyword is used to indicate if the base Id of the created</span>
<span class="sd">           function should be returned, instead of the default user Id.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            User Id or base Id of created function object.</span>
<span class="sd">            Will be 0 or negative if an error occurs.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">name_</span> <span class="o">=</span> <span class="n">_convert_char</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">tag_</span> <span class="o">=</span> <span class="n">_convert_char</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;tag&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
        <span class="n">bid_</span> <span class="o">=</span> <span class="n">_convert_bool</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;base_id&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">))</span>

        <span class="k">if</span> <span class="s2">&quot;xy&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="c1"># Polyline function, get abscissa and ordinate values</span>
            <span class="n">n_</span><span class="p">,</span> <span class="n">x_</span><span class="p">,</span> <span class="n">y_</span><span class="p">,</span> <span class="n">e_</span> <span class="o">=</span> <span class="n">_extract_polyline</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreatePolyFunc</span><span class="p">(</span><span class="n">name_</span><span class="p">,</span> <span class="n">tag_</span><span class="p">,</span> <span class="n">n_</span><span class="p">,</span> <span class="n">x_</span><span class="p">,</span> <span class="n">y_</span><span class="p">,</span> <span class="n">e_</span><span class="p">,</span> <span class="n">bid_</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;frequency&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="c1"># Sine function, get function parameters</span>
            <span class="n">sine_par</span> <span class="o">=</span> <span class="p">(</span><span class="n">c_double</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)()</span>
            <span class="n">sine_par</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_double</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;frequency&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
            <span class="n">sine_par</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_double</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;delay&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
            <span class="n">sine_par</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_double</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;amplitude&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
            <span class="n">sine_par</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_double</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mean_value&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
            <span class="n">sine_par</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_double</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;end&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateSineFunc</span><span class="p">(</span><span class="n">name_</span><span class="p">,</span> <span class="n">tag_</span><span class="p">,</span> <span class="n">sine_par</span><span class="p">,</span> <span class="n">bid_</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;filename&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="c1"># Polyline-from-file function</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateDeviceFunc</span><span class="p">(</span>
                <span class="n">name_</span><span class="p">,</span>
                <span class="n">tag_</span><span class="p">,</span>
                <span class="n">_convert_char</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;filename&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)),</span>
                <span class="n">_convert_char</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ch_name&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)),</span>
                <span class="n">_convert_real</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sc_factor&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)),</span>
                <span class="n">_convert_bool</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;z_adjust&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)),</span>
                <span class="n">_convert_real</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;v_shift&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)),</span>
                <span class="n">bid_</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;expression&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="c1"># Math expression function</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateMathExprFunc</span><span class="p">(</span>
                <span class="n">name_</span><span class="p">,</span> <span class="n">tag_</span><span class="p">,</span> <span class="n">_convert_char</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;expression&quot;</span><span class="p">]),</span> <span class="n">bid_</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;slope&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">or</span> <span class="s2">&quot;value&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">(</span><span class="n">c_double</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)(</span><span class="o">*</span><span class="p">([</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">))</span>
            <span class="k">if</span> <span class="s2">&quot;end_ramp&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>  <span class="c1"># Limited ramp function</span>
                <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_double</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;slope&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
                <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_double</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;start_val&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
                <span class="n">params</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_double</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;start_ramp&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
                <span class="n">params</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_double</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;end_ramp&quot;</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">))</span>
            <span class="k">elif</span> <span class="s2">&quot;start_ramp&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>  <span class="c1"># Ramp function</span>
                <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_double</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;slope&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
                <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_double</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;start_val&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
                <span class="n">params</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_double</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;start_ramp&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
                <span class="n">params</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">elif</span> <span class="s2">&quot;slope&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>  <span class="c1"># Linear function</span>
                <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_double</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;slope&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># Constant function</span>
                <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_double</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateLinearFunc</span><span class="p">(</span><span class="n">name_</span><span class="p">,</span> <span class="n">tag_</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">bid_</span><span class="p">)</span>

        <span class="c1"># By default (if kwargs is empty), create an external function</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateExternalFunc</span><span class="p">(</span><span class="n">name_</span><span class="p">,</span> <span class="n">tag_</span><span class="p">,</span> <span class="n">bid_</span><span class="p">)</span></div>


<div class="viewcode-block" id="FedemModeler.make_sensor">
<a class="viewcode-back" href="../modeler.html#modeler.FedemModeler.make_sensor">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">make_sensor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">dof</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a sensor object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Description of the new sensor</span>
<span class="sd">        obj : int or str or (int, int) or (str, str)</span>
<span class="sd">            Base Id or tag of object(s) to measure</span>
<span class="sd">        var : FmVar</span>
<span class="sd">            The variable to measure</span>
<span class="sd">        dof : FmDof, default=None</span>
<span class="sd">            Local DOF to measure if `var` is a multi-DOF quantity</span>
<span class="sd">        tag : str, default=None</span>
<span class="sd">            Tag to associate the created sensor with</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            User Id of sensor object, zero or negative on error</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">obj1_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_id</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">obj2_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_id</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">obj1_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_id</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="n">obj2_</span> <span class="o">=</span> <span class="n">c_int</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateSensor</span><span class="p">(</span>
            <span class="n">_convert_char</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
            <span class="n">_convert_char</span><span class="p">(</span><span class="n">tag</span><span class="p">),</span>
            <span class="n">_convert_int</span><span class="p">(</span><span class="n">var</span><span class="p">),</span>
            <span class="n">_convert_int</span><span class="p">(</span><span class="n">dof</span><span class="p">),</span>
            <span class="n">obj1_</span><span class="p">,</span>
            <span class="n">obj2_</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="FedemModeler.make_fe_part">
<a class="viewcode-back" href="../modeler.html#modeler.FedemModeler.make_fe_part">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">make_fe_part</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates an FE part.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        file : str</span>
<span class="sd">            Absolute path to the FE data file</span>
<span class="sd">        name : str, default=None</span>
<span class="sd">            Description of the new part, use file basename if not specified</span>
<span class="sd">        tag : str, default=None</span>
<span class="sd">            Tag to associate the created part with</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            Base Id of the FE part object, zero or negative on error</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">part</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmLoadPart</span><span class="p">(</span><span class="n">_convert_char</span><span class="p">(</span><span class="n">file</span><span class="p">),</span> <span class="n">_convert_char</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">tag</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">part</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fm_tag_object</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">part</span></div>


<div class="viewcode-block" id="FedemModeler.make_generic_part">
<a class="viewcode-back" href="../modeler.html#modeler.FedemModeler.make_generic_part">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">make_generic_part</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">triads</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a generic part.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Description of the new part</span>
<span class="sd">        triads : list of int or list of str</span>
<span class="sd">            List of base Ids or tags of the connected triads</span>
<span class="sd">        kwargs : dict</span>
<span class="sd">            Keyword arguments defining some element properties.</span>
<span class="sd">            Currently, the following keywords are recognized:</span>

<span class="sd">            * `alpha1` : Mass-proportional damping coefficient</span>
<span class="sd">            * `alpha2` : Stiffness-proportional damping coefficient</span>
<span class="sd">            * `tag` : Tag to associate the created element with</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            Base Id of the created generic part, zero of negative on error</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n_triads</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">triads</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n_triads</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; *** make_generic_part: No triads specified&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">0</span>

        <span class="n">n_</span> <span class="o">=</span> <span class="n">c_int</span><span class="p">(</span><span class="n">n_triads</span><span class="p">)</span>
        <span class="n">t_</span> <span class="o">=</span> <span class="p">(</span><span class="n">c_int</span> <span class="o">*</span> <span class="n">n_triads</span><span class="p">)()</span>
        <span class="n">tr_</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_convert_id</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">FmType</span><span class="o">.</span><span class="n">TRIAD</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">triads</span><span class="p">]</span>
        <span class="n">base_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreatePart</span><span class="p">(</span><span class="n">_convert_char</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">n_</span><span class="p">,</span> <span class="n">tr_</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">base_id</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">base_id</span>

        <span class="k">if</span> <span class="s2">&quot;alpha1&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">or</span> <span class="s2">&quot;alpha2&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmStructDamp</span><span class="p">(</span>
                <span class="n">base_id</span><span class="p">,</span>
                <span class="n">_convert_real</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;alpha1&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)),</span>
                <span class="n">_convert_real</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;alpha2&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)),</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;tag&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fm_tag_object</span><span class="p">(</span><span class="n">base_id</span><span class="p">,</span> <span class="n">_convert_char</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;tag&quot;</span><span class="p">]))</span>

        <span class="k">return</span> <span class="n">base_id</span></div>


<div class="viewcode-block" id="FedemModeler.make_strain_rosette">
<a class="viewcode-back" href="../modeler.html#modeler.FedemModeler.make_strain_rosette">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">make_strain_rosette</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">part_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a strain rosette on an FE part.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Description of the new strain rosette</span>
<span class="sd">        part_id : int or str</span>
<span class="sd">            Base Id or tag of FE part on which the rosette will be created</span>
<span class="sd">        kwargs : dict</span>
<span class="sd">            Keyword arguments defining the strain rosette properties.</span>
<span class="sd">            The following keywords are recognized:</span>

<span class="sd">            * `tag` : Tag to associate the created strain rosette with</span>
<span class="sd">            * `nodes`: List of nodes to connect the strain rosette to</span>
<span class="sd">            * `pos`: List of connection point coordinates, on the format</span>
<span class="sd">              `[(x1,y1,z1), (x2,y2,z2), (x3,y3,z3), (x4,y4,z4)]`.</span>
<span class="sd">              The last tuple is skipped if a 3-noded rosette is desired.</span>
<span class="sd">            * `direction`: Tuple `(x,y,z)` defining the local `X`-axis</span>
<span class="sd">              direction vector of the strain rosette</span>
<span class="sd">            * `angle` : Angle between strain gage direction and local X-axis</span>
<span class="sd">            * `start_at_zero` : If True, the start strains are set to zero</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            Base Id of the strain rosette, zero or negative on error</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name_</span> <span class="o">=</span> <span class="n">_convert_char</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">part_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_id</span><span class="p">(</span><span class="n">part_id</span><span class="p">,</span> <span class="n">FmType</span><span class="o">.</span><span class="n">FEPART</span><span class="p">)</span>

        <span class="n">nodes_</span> <span class="o">=</span> <span class="p">(</span><span class="n">c_int</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)()</span>
        <span class="n">node_id</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nodes&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">node_pos</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pos&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node_pos</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="c1"># Nodal positions are provided, find the closest FE nodes</span>
            <span class="n">nnod_</span> <span class="o">=</span> <span class="n">c_int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">node_pos</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">pos</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">node_pos</span><span class="p">):</span>
                <span class="n">nodes_</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fm_get_node</span><span class="p">(</span><span class="n">part_</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node_id</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="c1"># The node Id&#39;s are provided directly</span>
            <span class="n">nnod_</span> <span class="o">=</span> <span class="n">c_int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">node_id</span><span class="p">))</span>
            <span class="n">nodes_</span><span class="p">[</span><span class="mi">0</span> <span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">node_id</span><span class="p">)]</span> <span class="o">=</span> <span class="n">node_id</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; *** Neither nodes nor pos is specified&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

        <span class="n">dirvec_</span> <span class="o">=</span> <span class="p">(</span><span class="n">c_double</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)()</span>
        <span class="n">direction</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;direction&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">direction</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">dirvec_</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">direction</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dirvec_</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>

        <span class="n">ros</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateStrainRosette</span><span class="p">(</span>
            <span class="n">name_</span><span class="p">,</span>
            <span class="n">part_</span><span class="p">,</span>
            <span class="n">nnod_</span><span class="p">,</span>
            <span class="n">nodes_</span><span class="p">,</span>
            <span class="n">dirvec_</span><span class="p">,</span>
            <span class="n">_convert_real</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;angle&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)),</span>
            <span class="n">_convert_bool</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;start_at_zero&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)),</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">ros</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Activate strain gage recovery during solve for this part</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmRecoverOpts</span><span class="p">(</span><span class="n">part_</span><span class="p">,</span> <span class="n">c_int</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">c_bool</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>

        <span class="k">if</span> <span class="s2">&quot;tag&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">ros</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fm_tag_object</span><span class="p">(</span><span class="n">ros</span><span class="p">,</span> <span class="n">_convert_char</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;tag&quot;</span><span class="p">]))</span>

        <span class="k">return</span> <span class="n">ros</span></div>


<div class="viewcode-block" id="FedemModeler.make_udelm">
<a class="viewcode-back" href="../modeler.html#modeler.FedemModeler.make_udelm">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">make_udelm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">triads</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a string of 2-noded user-defined elements.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Description of the new element(s)</span>
<span class="sd">        triads : list of int or list of str</span>
<span class="sd">            List of base Ids or tags of the connected triads</span>
<span class="sd">        kwargs : dict</span>
<span class="sd">            Keyword arguments defining some element properties.</span>
<span class="sd">            Currently, the following keywords are recognized:</span>

<span class="sd">            * `alpha1` : Mass-proportional damping coefficient</span>
<span class="sd">            * `alpha2` : Stiffness-proportional damping coefficient</span>
<span class="sd">            * `tag` : Tag to associate the created element with</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list of int</span>
<span class="sd">            Base Ids of the created elements, None if error</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">triads</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; *** make_udelm: At least two triads must be specified&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">base_ids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">triads</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">base_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateUDE2</span><span class="p">(</span>
                <span class="n">_convert_char</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_convert_id</span><span class="p">(</span><span class="n">triads</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">FmType</span><span class="o">.</span><span class="n">TRIAD</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_convert_id</span><span class="p">(</span><span class="n">triads</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">FmType</span><span class="o">.</span><span class="n">TRIAD</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">base_id</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="n">base_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">base_id</span><span class="p">)</span>

            <span class="k">if</span> <span class="s2">&quot;alpha1&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">or</span> <span class="s2">&quot;alpha2&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmStructDamp</span><span class="p">(</span>
                    <span class="n">base_id</span><span class="p">,</span>
                    <span class="n">_convert_real</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;alpha1&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)),</span>
                    <span class="n">_convert_real</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;alpha2&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)),</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;tag&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fm_tag_object</span><span class="p">(</span><span class="n">base_ids</span><span class="p">,</span> <span class="n">_convert_char</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;tag&quot;</span><span class="p">]))</span>

        <span class="k">return</span> <span class="n">base_ids</span></div>


<div class="viewcode-block" id="FedemModeler.make_assembly">
<a class="viewcode-back" href="../modeler.html#modeler.FedemModeler.make_assembly">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">make_assembly</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">objs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a sub-assembly and moves the specified objects into it.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Description of the new sub-assembly</span>
<span class="sd">        objs : list of int or str or list of str, default=None</span>
<span class="sd">            List of base Ids or tags of the objects to put into the new sub-assembly</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            Base Id of the created sub-assembly</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">obj_ids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objs</span><span class="p">:</span>
                <span class="n">id_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_id</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">FmType</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">id_</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">obj_ids</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">id_</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">obj_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">id_</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">obj_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_id</span><span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">FmType</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">c_int</span><span class="p">)):</span>
            <span class="n">obj_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">objs</span><span class="p">]</span>

        <span class="n">num_obj_</span><span class="p">,</span> <span class="n">obj_ids_</span> <span class="o">=</span> <span class="n">_convert_int_array</span><span class="p">(</span><span class="n">obj_ids</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmCreateAssembly</span><span class="p">(</span><span class="n">_convert_char</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">num_obj_</span><span class="p">,</span> <span class="n">obj_ids_</span><span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_move_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_id</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Moves an existing object identified by its base Id.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dofs_</span> <span class="o">=</span> <span class="n">_extract_dofs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dofs_</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>  <span class="c1"># No movement specified, silently ignore</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmMoveObject</span><span class="p">(</span>
            <span class="n">_convert_int</span><span class="p">(</span><span class="n">base_id</span><span class="p">),</span>
            <span class="n">dofs_</span><span class="p">,</span>
            <span class="n">_convert_int</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;tra_ref&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
            <span class="n">_convert_int</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rot_ref&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_constrain_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_id</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constrains DOFs in an existing object identified by its base Id.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>  <span class="c1"># No constraints specified, silently ignore</span>

        <span class="n">dof_tags</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Tx&quot;</span><span class="p">,</span> <span class="s2">&quot;Ty&quot;</span><span class="p">,</span> <span class="s2">&quot;Tz&quot;</span><span class="p">,</span> <span class="s2">&quot;Rx&quot;</span><span class="p">,</span> <span class="s2">&quot;Ry&quot;</span><span class="p">,</span> <span class="s2">&quot;Rz&quot;</span><span class="p">,</span> <span class="s2">&quot;All&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dof_tags</span><span class="p">:</span>
                <span class="n">dof_</span> <span class="o">=</span> <span class="n">c_int</span><span class="p">(</span><span class="n">dof_tags</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
                <span class="n">con_</span> <span class="o">=</span> <span class="n">_convert_int</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">FmDofStat</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Constraining </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> in object [</span><span class="si">{</span><span class="n">base_id</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmConstrainObject</span><span class="p">(</span><span class="n">base_id</span><span class="p">,</span> <span class="n">dof_</span><span class="p">,</span> <span class="n">con_</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_dof_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_id</span><span class="p">,</span> <span class="n">prt</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assigns a DOF property in an existing object identified by its base Id.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>  <span class="c1"># No properties specified, silently ignore</span>

        <span class="n">pr_type_</span> <span class="o">=</span> <span class="n">c_int</span><span class="p">(</span><span class="n">prt</span><span class="p">)</span>
        <span class="n">dof_tags</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Tx&quot;</span><span class="p">,</span> <span class="s2">&quot;Ty&quot;</span><span class="p">,</span> <span class="s2">&quot;Tz&quot;</span><span class="p">,</span> <span class="s2">&quot;Rx&quot;</span><span class="p">,</span> <span class="s2">&quot;Ry&quot;</span><span class="p">,</span> <span class="s2">&quot;Rz&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dof_tags</span><span class="p">:</span>
                <span class="n">dof_</span> <span class="o">=</span> <span class="n">c_int</span><span class="p">(</span><span class="n">dof_tags</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">prt</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
                    <span class="n">fcn_</span> <span class="o">=</span> <span class="n">_convert_int</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">int_or_none</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fcn_</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="n">fcn_</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># A constant property value is specified</span>
                    <span class="n">val_</span> <span class="o">=</span> <span class="n">_convert_real</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="n">fcn_</span> <span class="o">=</span> <span class="n">c_int</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># The user Id of a general function is specified</span>
                    <span class="n">val_</span> <span class="o">=</span> <span class="n">c_double</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> property </span><span class="si">{</span><span class="n">prt</span><span class="si">}</span><span class="s2"> in object [</span><span class="si">{</span><span class="n">base_id</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">fcn_</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmDofProperty</span><span class="p">(</span><span class="n">base_id</span><span class="p">,</span> <span class="n">dof_</span><span class="p">,</span> <span class="n">pr_type_</span><span class="p">,</span> <span class="n">val_</span><span class="p">,</span> <span class="n">fcn_</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="kc">True</span>

<div class="viewcode-block" id="FedemModeler.edit_triad">
<a class="viewcode-back" href="../modeler.html#modeler.FedemModeler.edit_triad">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">edit_triad</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Modifies an existing triad.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        obj_id : int or str or list of int or list of str</span>
<span class="sd">            Base Id or tag of the triad(s) to modify</span>

<span class="sd">        kwargs : dict</span>
<span class="sd">            Keyword arguments containing the new triad attributes to assign.</span>
<span class="sd">            Currently, the following keywords are recognized:</span>

<span class="sd">            * Tx, Ty, Tz : Translation offset in global X, Y, and Z-direction</span>
<span class="sd">            * Rx, Ry, Rz : Euler angles (in degrees) for rotating the Triad</span>
<span class="sd">            * tra_ref : Base Id of object used as translation reference</span>
<span class="sd">            * rot_ref : Base Id of object used as rotation reference</span>
<span class="sd">            * mass : Additional mass (and inertia) on the Triad</span>
<span class="sd">            * mass_func : User Id or base Id (if negative) of mass scaling function</span>

<span class="sd">            * constraints : Dictionary with keywords for constraing DOFs, i.e.,</span>
<span class="sd">              ``constraints={&quot;Tx&quot; : &lt;value&gt;, ..., &quot;Rz&quot; : &lt;value&gt;}``, where</span>
<span class="sd">              ``&lt;value&gt;`` can be any of the enum values :class:`enums.FmDofStat`.</span>
<span class="sd">              Only the DOFs that should be changed need to be specified.</span>
<span class="sd">              You can also use &quot;All&quot; as key which implies all DOFs in the triad.</span>

<span class="sd">            * init_vel : Dictionary with keywords specifying initial velocities,</span>
<span class="sd">              i.e., ``init_vel={&quot;Tx&quot; : &lt;u01&gt;, ..., &quot;Rz&quot; : &lt;u06&gt;}``, where</span>
<span class="sd">              ``&lt;u0i&gt;`` is the initial velocity to be assigned local dof `i`.</span>

<span class="sd">            * load : Dictionary with keywords specifying constant DOF loads,</span>
<span class="sd">              i.e., ``load={&quot;Tx&quot; : &lt;f1&gt;, ..., &quot;Rz&quot; : &lt;f6&gt;}``, where</span>
<span class="sd">              ``&lt;fi&gt;`` is the user Id of a general function defining the load</span>
<span class="sd">              in local dof `i` if the type is int, otherwise it is taken as the</span>
<span class="sd">              constant load to be assigned local dof `i`.</span>

<span class="sd">            * motion : Dictionary with keywords specifying prescribed motions,</span>
<span class="sd">              i.e., ``motion={&quot;Tx&quot; : &lt;u1&gt;, ..., &quot;Rz&quot; : &lt;u6&gt;}``, where</span>
<span class="sd">              ``&lt;ui&gt;`` is the user Id of a general function defining the motion</span>
<span class="sd">              in local dof `i` if the type is int, otherwise it is taken as the</span>
<span class="sd">              constant motion to be prescribed in local dof `i`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True if the input is valid, otherwise False</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Convert tag to base Id or list of base Id</span>
        <span class="n">base_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_ids</span><span class="p">(</span><span class="n">obj_id</span><span class="p">,</span> <span class="n">FmType</span><span class="o">.</span><span class="n">TRIAD</span><span class="p">)</span>

        <span class="n">retval</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base_id</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>  <span class="c1"># Process a list of triads</span>
            <span class="k">for</span> <span class="n">bid</span> <span class="ow">in</span> <span class="n">base_id</span><span class="p">:</span>
                <span class="n">retval</span> <span class="o">&amp;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit_triad</span><span class="p">(</span><span class="n">bid</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">retval</span>

        <span class="n">retval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_move_object</span><span class="p">(</span><span class="n">base_id</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">retval</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; *** Failed to move triad&quot;</span><span class="p">,</span> <span class="n">base_id</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

        <span class="n">mass</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mass&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mass</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mass</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">n_</span><span class="p">,</span> <span class="n">m_</span> <span class="o">=</span> <span class="n">_convert_float_array</span><span class="p">(</span><span class="n">mass</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">n_</span> <span class="o">=</span> <span class="n">c_int</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">m_</span> <span class="o">=</span> <span class="p">(</span><span class="n">c_double</span> <span class="o">*</span> <span class="mi">1</span><span class="p">)(</span><span class="n">_convert_real</span><span class="p">(</span><span class="n">mass</span><span class="p">))</span>
            <span class="n">mfunc_</span> <span class="o">=</span> <span class="n">_convert_int</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mass_function&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmAddMass</span><span class="p">(</span><span class="n">base_id</span><span class="p">,</span> <span class="n">n_</span><span class="p">,</span> <span class="n">m_</span><span class="p">,</span> <span class="n">mfunc_</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; *** Failed to add mass on triad&quot;</span><span class="p">,</span> <span class="n">base_id</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                <span class="n">retval</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_constrain_object</span><span class="p">(</span><span class="n">base_id</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;constraints&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; *** Failed to constrain triad&quot;</span><span class="p">,</span> <span class="n">base_id</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="n">retval</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dof_property</span><span class="p">(</span><span class="n">base_id</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;init_vel&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; *** Failed to assign initial velocity to triad&quot;</span><span class="p">,</span> <span class="n">base_id</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="n">retval</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">load</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;load&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">load</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">load</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;motion&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dof_property</span><span class="p">(</span><span class="n">base_id</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">load</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; *** Failed to assign load/motion to triad&quot;</span><span class="p">,</span> <span class="n">base_id</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="n">retval</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="n">retval</span></div>


<div class="viewcode-block" id="FedemModeler.edit_part">
<a class="viewcode-back" href="../modeler.html#modeler.FedemModeler.edit_part">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">edit_part</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Modifies an existing FE part.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        obj_id : int or str or list of int or list of str</span>
<span class="sd">            Base Id or tag of the part(s) to modify</span>

<span class="sd">        kwargs : dict</span>
<span class="sd">            Keyword arguments containing the new part attributes to assign.</span>
<span class="sd">            Currently, the following keywords are recognized:</span>

<span class="sd">            * Tx, Ty, Tz : Translation offset in global X, Y, and Z-direction</span>
<span class="sd">            * Rx, Ry, Rz : Euler angles (in degrees) for rotating the Part</span>
<span class="sd">            * tra_ref : Base Id of object used as translation reference</span>
<span class="sd">            * rot_ref : Base Id of object used as rotation reference</span>
<span class="sd">            * alpha1 : Mass-proportional damping coefficient</span>
<span class="sd">            * alpha2 : Stiffness-proportional damping coefficient</span>
<span class="sd">            * component_modes : Number of component modes</span>
<span class="sd">            * consistent_mass : If True, use consistent mass (lumped is default)</span>
<span class="sd">            * recovery : Flag for activating FE part recovery during solve</span>
<span class="sd">              (0=off, 1=stress recovery, 2=strain gage recovery, 3=both)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True if the input is valid, otherwise False</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Convert tag to base Id or list of base Id</span>
        <span class="n">base_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_ids</span><span class="p">(</span><span class="n">obj_id</span><span class="p">,</span> <span class="n">FmType</span><span class="o">.</span><span class="n">FEPART</span><span class="p">)</span>

        <span class="n">retval</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base_id</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>  <span class="c1"># Process a list of parts</span>
            <span class="k">for</span> <span class="n">bid</span> <span class="ow">in</span> <span class="n">base_id</span><span class="p">:</span>
                <span class="n">retval</span> <span class="o">&amp;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit_part</span><span class="p">(</span><span class="n">bid</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">retval</span>

        <span class="n">retval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_move_object</span><span class="p">(</span><span class="n">base_id</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;alpha1&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">or</span> <span class="s2">&quot;alpha2&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">retval</span> <span class="o">=</span> <span class="n">retval</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmStructDamp</span><span class="p">(</span>
                <span class="n">base_id</span><span class="p">,</span>
                <span class="n">_convert_real</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;alpha1&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)),</span>
                <span class="n">_convert_real</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;alpha2&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)),</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;component_modes&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">or</span> <span class="s2">&quot;consistent_mass&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">retval</span> <span class="o">=</span> <span class="n">retval</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmReduceOpts</span><span class="p">(</span>
                <span class="n">base_id</span><span class="p">,</span>
                <span class="n">_convert_int</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;component_modes&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
                <span class="n">_convert_bool</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;consistent_mass&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)),</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;recovery&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">retval</span> <span class="o">=</span> <span class="n">retval</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmRecoverOpts</span><span class="p">(</span>
                <span class="n">base_id</span><span class="p">,</span> <span class="n">_convert_int</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;recovery&quot;</span><span class="p">]),</span> <span class="n">c_bool</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">retval</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; *** Failed to edit properties on part&quot;</span><span class="p">,</span> <span class="n">base_id</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">retval</span></div>


<div class="viewcode-block" id="FedemModeler.edit_joint">
<a class="viewcode-back" href="../modeler.html#modeler.FedemModeler.edit_joint">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">edit_joint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Modifies an existing joint.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        obj_id : int or str or list of int or list of str</span>
<span class="sd">            Base Id or tag of the joint(s) to modify</span>

<span class="sd">        kwargs : dict</span>
<span class="sd">            Keyword arguments containing the new joint attributes to assign.</span>
<span class="sd">            Currently, the following keywords are recognized:</span>

<span class="sd">            * Tx, Ty, Tz : Translation offset in global X, Y, and Z-direction</span>
<span class="sd">            * Rx, Ry, Rz : Euler angles (in degrees) for rotating the joint</span>
<span class="sd">            * tra_ref : Base Id of object used as translation reference</span>
<span class="sd">            * rot_ref : Base Id of object used as rotation reference</span>

<span class="sd">            * constraints : Dictionary with keywords for constraing DOFs, i.e.,</span>
<span class="sd">              ``constraints={&quot;Tx&quot; : &lt;value&gt;, ..., &quot;Rz&quot; : &lt;value&gt;}``, where</span>
<span class="sd">              ``&lt;value&gt;`` can be any of the enum values :class:`enums.FmDofStat`.</span>
<span class="sd">              Only the DOFs that should be changed need to be specified.</span>
<span class="sd">              You can also use &quot;All&quot; as key which implies all DOFs in the joint.</span>

<span class="sd">            * init_vel : Dictionary with keywords specifying initial velocities,</span>
<span class="sd">              i.e., ``init_vel={&quot;Tx&quot; : &lt;u01&gt;, ..., &quot;Rz&quot; : &lt;u06&gt;}``, where</span>
<span class="sd">              ``&lt;u0i&gt;`` is the initial velocity to be assigned local dof `i`.</span>

<span class="sd">            * load : Dictionary with keywords specifying constant DOF loads,</span>
<span class="sd">              i.e., ``load={&quot;Tx&quot; : &lt;f1&gt;, ..., &quot;Rz&quot; : &lt;f6&gt;}``, where</span>
<span class="sd">              ``&lt;fi&gt;`` is the user Id of a general function defining the load</span>
<span class="sd">              in local dof `i` if the type is int, otherwise it is taken as the</span>
<span class="sd">              constant load to be assigned local dof `i`.</span>

<span class="sd">            * motion : Dictionary with keywords specifying prescribed motions,</span>
<span class="sd">              i.e., ``motion={&quot;Tx&quot; : &lt;u1&gt;, ..., &quot;Rz&quot; : &lt;u6&gt;}``, where</span>
<span class="sd">              ``&lt;ui&gt;`` is the user Id of a general function defining the motion</span>
<span class="sd">              in local dof `i` if the type is int, otherwise it is taken as the</span>
<span class="sd">              constant motion to be prescribed in local dof `i`.</span>

<span class="sd">            * spring : Dictionary with keywords specifying spring stiffnesses,</span>
<span class="sd">              i.e., ``spring={&quot;Tx&quot; : &lt;k1&gt;, ..., &quot;Rz&quot; : &lt;k6&gt;}``, where</span>
<span class="sd">              ``&lt;ki&gt;`` is the constant stiffness to be assigned local dof `i`.</span>

<span class="sd">            * damper : Dictionary with keywords specifying damping coefficients,</span>
<span class="sd">              i.e., ``load={&quot;Tx&quot; : &lt;c1&gt;, ..., &quot;Rz&quot; : &lt;c6&gt;}``, where</span>
<span class="sd">              ``&lt;ci&gt;`` is the constant damping to be assigned local dof `i`.</span>

<span class="sd">            * length : Dictionary with keywords specifying stress-free lengths,</span>
<span class="sd">              i.e., ``length={&quot;Tx&quot; : &lt;l1&gt;, ..., &quot;Rz&quot; : &lt;l6&gt;}``, where</span>
<span class="sd">              ``&lt;li&gt;`` is the user Id of a general function defining the</span>
<span class="sd">              stress-free length in local dof `i`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True if the input is valid, otherwise False</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Convert tag to base Id or list of base Id</span>
        <span class="n">base_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_ids</span><span class="p">(</span><span class="n">obj_id</span><span class="p">,</span> <span class="n">FmType</span><span class="o">.</span><span class="n">JOINT</span><span class="p">)</span>

        <span class="n">retval</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base_id</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>  <span class="c1"># Process a list of joints</span>
            <span class="k">for</span> <span class="n">bid</span> <span class="ow">in</span> <span class="n">base_id</span><span class="p">:</span>
                <span class="n">retval</span> <span class="o">&amp;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit_joint</span><span class="p">(</span><span class="n">bid</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">retval</span>

        <span class="n">retval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_move_object</span><span class="p">(</span><span class="n">base_id</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">retval</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; *** Failed to move joint&quot;</span><span class="p">,</span> <span class="n">base_id</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_constrain_object</span><span class="p">(</span><span class="n">base_id</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;constraints&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; *** Failed to constrain joint&quot;</span><span class="p">,</span> <span class="n">base_id</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="n">retval</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dof_property</span><span class="p">(</span><span class="n">base_id</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;init_vel&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; *** Failed to assign initial velocity to joint&quot;</span><span class="p">,</span> <span class="n">base_id</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="n">retval</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">load</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;load&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">load</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">load</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;motion&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dof_property</span><span class="p">(</span><span class="n">base_id</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">load</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; *** Failed to assign load/motion to joint&quot;</span><span class="p">,</span> <span class="n">base_id</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="n">retval</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dof_property</span><span class="p">(</span><span class="n">base_id</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;spring&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; *** Failed to assign spring stiffness to joint&quot;</span><span class="p">,</span> <span class="n">base_id</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="n">retval</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dof_property</span><span class="p">(</span><span class="n">base_id</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;damper&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; *** Failed to assign damping coefficient to joint&quot;</span><span class="p">,</span> <span class="n">base_id</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="n">retval</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dof_property</span><span class="p">(</span><span class="n">base_id</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;length&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; *** Failed to assign stress-free lengths to joint&quot;</span><span class="p">,</span> <span class="n">base_id</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="n">retval</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="n">retval</span></div>


<div class="viewcode-block" id="FedemModeler.edit_function">
<a class="viewcode-back" href="../modeler.html#modeler.FedemModeler.edit_function">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">edit_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func_id</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dof</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Modifies an existing function by changing its argument.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        func_id : int</span>
<span class="sd">            User Id (or base Id, if negative) of the function to modify</span>
<span class="sd">        obj : int or str or (int, int) or (str, str)</span>
<span class="sd">            Base Id or tag of object(s) producing the response quantity to use</span>
<span class="sd">        var : FmVar, default=None=0</span>
<span class="sd">            Response quantity to use as function argument</span>
<span class="sd">        dof : FmDof, default=None=0</span>
<span class="sd">            Which component of `var` to be used if a multi-DOF quantity</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True if the input is valid, otherwise False</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">obj1_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_id</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">obj2_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_id</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">obj1_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_id</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="n">obj2_</span> <span class="o">=</span> <span class="n">c_int</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">retval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmlib</span><span class="o">.</span><span class="n">FmSetFunctionArg</span><span class="p">(</span>
            <span class="n">_convert_int</span><span class="p">(</span><span class="n">func_id</span><span class="p">),</span>
            <span class="n">_convert_int</span><span class="p">(</span><span class="n">var</span><span class="p">),</span>
            <span class="n">_convert_int</span><span class="p">(</span><span class="n">dof</span><span class="p">),</span>
            <span class="n">obj1_</span><span class="p">,</span>
            <span class="n">obj2_</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">retval</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; *** Failed to change argument of Function&quot;</span><span class="p">,</span> <span class="n">func_id</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;     to&quot;</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">dof</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">retval</span></div>


<div class="viewcode-block" id="FedemModeler.solver_setup">
<a class="viewcode-back" href="../modeler.html#modeler.FedemModeler.solver_setup">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">solver_setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Setting up solver parameters, t_quasi, t_inc and t_end.</span>
<span class="sd">        Switching off initial equilibrium by setting t_quasi negative.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        kwargs : dict</span>
<span class="sd">            Keyword arguments containing the solver settings to assign.</span>
<span class="sd">            Currently, the following keywords are recognized:</span>

<span class="sd">            * t_start : Start time</span>
<span class="sd">            * t_end : Stop time</span>
<span class="sd">            * t_inc : Time step size</span>
<span class="sd">            * t_quasi : Stop time for quasi-static simulation.</span>
<span class="sd">                        If equal to t_start, perform initial equilibrium analysis</span>
<span class="sd">                        before starting the dynamics time integration.</span>
<span class="sd">            * n_modes : If non-zero, perform eigenvalue analysis during the simulation,</span>
<span class="sd">                        and calculate this number of modes each time</span>
<span class="sd">            * e_inc: Time between each eigenvalue analysis</span>
<span class="sd">            * add_opt: Additional solver options</span>
<span class="sd">            * tol_ene: Convergence tolerance in energy norm</span>
<span class="sd">            * tol_dis: Convergence tolerance in displacement norm</span>
<span class="sd">            * tol_vel: Convergence tolerance in velocity norm</span>
<span class="sd">            * tol_res: Convergence tolerance in force residual norm</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fm_solver_setup</span><span class="p">(</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;t_start&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;t_end&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;t_inc&quot;</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">),</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;t_quasi&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;n_modes&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;e_inc&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;add_opt&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">{</span><span class="s2">&quot;tol_ene&quot;</span><span class="p">,</span> <span class="s2">&quot;tol_dis&quot;</span><span class="p">,</span> <span class="s2">&quot;tol_vel&quot;</span><span class="p">,</span> <span class="s2">&quot;tol_res&quot;</span><span class="p">})</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fm_solver_tol</span><span class="p">(</span>
                <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;tol_ene&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">),</span>
                <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;tol_dis&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">),</span>
                <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;tol_vel&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">),</span>
                <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;tol_res&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">),</span>
            <span class="p">)</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, SAP SE.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>